<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NCML2RV');</script>
  

  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
  <link rel="stylesheet" href="/css/destyle.css">
  <style>
    body {
        background-color: #f1f1f1;
        line-height: 1.3;
        
        font-family: "Helvetica Neue", 
            Arial, 
            "Hiragino Kaku Gothic ProN",
            "Hiragino Sans",
            "BIZ UDPGothic",
            Meiryo,
            sans-serif;
    }

    table {
        margin-block-start: 1.5rem;
        margin-block-end: 1.5rem;
    }

    table th,table td{
        padding: 0.2rem 1.0rem;
    }

    table tr{
        border-bottom: solid 1px #eee;
    }

    .languages {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 1.2rem;
        color: #3a9240;
    }

    header {
        margin-block-start: 1.875rem;
        margin-block-end: 1.875rem;
    }

    header>.title {
        font-size: 1.875rem;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .sns {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .sns-item {
        display: inline-block;
        margin: 3px;
    }

    .filmarks {
        display: inline-block;
        width: 32px;
        height: 32px;
        margin-top: 3px;
        background: url(/image/filmarks.svg) no-repeat;
        background-size: 450%;
    }

    header>.tags {
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.2rem;
        max-width: 1000px;
        margin: auto;
        padding: 0 20px;
    }

    header>.tags .others {
        font-weight: bold;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .nl {
        display: inline-block;
    }

    .cell {
        background-color: #fff;
        border-radius: 5px;
        padding: 10px;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.1) inset;
    }

    time {
        color: #333;
    }

    .tag {
        color: #3a9240;
        margin: 0 5px;
    }

    .tag:hover {
        text-decoration: underline;
    }

     
    .paging {
        display: inline-block;
        font-size: 1.25rem;
        margin: 10px 10px;
    }

    .paging.next {
        float: right;
    }


     
    .list>.title {
        font-size: 1.75rem;
        margin: 0 0 10px 10px;
    }

     
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(262px, 1fr));
        gap: 20px;
        margin: 0 10px;
    }

    .grid-nl {
        width: 100%;
    }

    .grid-cell {
        height: 11.25rem;
        overflow: hidden;
        box-sizing: content-box;
    }

    .grid-cell>.title {
        font-size: 1.4rem;
        word-wrap: break-word;
    }

     
    .single {
        margin: 0 10px 10px 10px;
        line-height: 1.5;
    }

    @media screen and (min-width: 768px) {
        .single .cell {
            padding: 10px 20px;
        }
    }

    .single-header {
        margin-block-start: 1.875rem;
        margin-block-end: 1.875rem;
        line-height: 1.3;
    }

    .single-header h1 {
        font-size: 2rem;
        font-weight: bold;
    }

    .single h2 {
        font-size: 1.8rem;
        border-bottom: 1px solid #ddd;
        margin-block-start: 1.875rem;
    }

    .single h3 {
        font-size: 1.5rem;
        margin-block-start: 1.5rem;
    }

    .single h4 {
        font-size: 1.2rem;
        margin-block-start: 1rem;
    }

    .single a {
        color: #3a9240;
    }

    .single a:hover {
        text-decoration: underline;
    }

    .single p {
        margin-block-start: 0.83rem;
        margin-block-end: 0.83rem;
    }

    code {
        
        font-family: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;
    }

    .single p>code, .single li>code {
        padding: 0 0.2rem;
        display: inline-block;
        overflow: auto;
        max-width: 100%;
        vertical-align: bottom;
    }

    .single strong {
        color: #d2691e;
        font-weight: normal;
    }

    .single .highlight {
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.1) inset;
        margin-block-start: 1rem;
        margin-block-end: 1rem;
        font-size: 0.875rem;
    }

    .single .img_container {
        margin-block-start: 0.1rem;
        margin-block-end: 0.1rem;
        text-align: center;
    }

    .single img {
        border: 1px solid #ddd;
    }

    .share-button > img {
        border: none;
    }

    .single .highlight>pre {
        padding: 10px;
        overflow-x: auto;
    }

    .single img {
        max-width: 100%;
    }

    .single blockquote {
        border-left: 5px solid #ddd;
        color: #777;
        padding: 1rem 0 1rem 1rem;
        margin-block-start: 0.83rem;
        margin-block-end: 0.83rem;
    }

    .single blockquote > p {
        margin-block-start: 0;
        margin-block-end: 0;
    }

    .single hr {
        color: #bbb;
        margin-block-start: 1.5rem;
        margin-block-end: 1.5rem;
    }

    .single ul {
        list-style-type: disc;
        padding-left: 1.5em;
        margin-block-end: 0.4rem;
    }

    .share {
        position: relative;
        text-align: right;
        margin-top: 5px;
    }

    .share .cell {
        display: inline-block;
        text-align: center;
        margin-bottom: 5px;
    }

    .share-button {
        display: inline-block;
        margin: 0 5px;
    }

    @media screen and (min-width: 1400px) {
        .share .cell {
            position: absolute;
            bottom: 0;
            margin-left: 5px;
        }

        .share-button {
            display: inline-block;
            margin: 5px 0;
        }
    }
</style>
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://www.sambaiz.net/index.xml">
  <link rel="icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">

  <meta name="theme-color" content="#41a248">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@sambaiz">
  
  <title>Express dependencies on past tasks in Airflow - sambaiz-net</title>
  <meta name="twitter:title" content="Express dependencies on past tasks in Airflow - sambaiz-net">
  <meta property='og:title' content="Express dependencies on past tasks in Airflow - sambaiz-net">
  <meta property="og:type" content="article">
  
  <meta name="description" content="depends_on_past, ExternalTaskSensor, ExternalTaskMarker">
  <meta name="twitter:description" content="depends_on_past, ExternalTaskSensor, ExternalTaskMarker">
  
  

  <meta property="og:url" content="https://www.sambaiz.net/en/article/429/">
  <meta property="og:image" content="https://www.sambaiz.net/images/my_l.jpg">
  <meta name="twitter:image" content="https://www.sambaiz.net/images/my.jpg" />

  
  
  <link rel="alternate" hreflang="ja" href="https://www.sambaiz.net/article/429/" />
  
  <link rel="alternate" hreflang="x-default" href="https://www.sambaiz.net/article/429/" />
  
  
  <link rel="alternate" hreflang="en" href="https://www.sambaiz.net/en/article/429/" />
  
  
  

  
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id": "https://www.sambaiz.net/"
    },
    "headline": "Express dependencies on past tasks in Airflow",
    "datePublished": "2022-11-30T09:34:00JST",
    "dateModified": "2022-11-30T09:34:00JST",
    "author": {
      "@type": "Person",
      "name": "sambaiz",
      "url": "https://www.sambaiz.net/",
      "image": "https://www.sambaiz.net/images/my.jpg"
    },
    "publisher": {
      "@type": "Person",
      "name": "sambaiz-net",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.sambaiz.net/images/my.jpg",
        "height": 60,
        "width": 60
      }
    },
    "image": {
      "@type": "ImageObject",
      "url": "https://www.sambaiz.net/images/my.jpg",
      "height": 138,
      "width": 138
    },
    "description": "depends_on_past, ExternalTaskSensor, ExternalTaskMarker"
  }
</script>
</head>

<body>
  
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCML2RV"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <div>
    <div class="languages">
      
      <ul>
          
          <li>
              <a href="https://www.sambaiz.net/article/429/">日本語</a>
          </li>
          
      </ul>
      
    </div>

    <header>
      <div class="title">
        <img src="https://www.sambaiz.net/images/my.png" width="60px" height="60px" alt="icon" />
        <a class="nl" href='/en/'>
          <h1>sambaiz-net</h1>
        </a>
      </div>

      <div class="sns">
        <div class="sns-item">
          <a class="nl" href="https://github.com/sambaiz">
            <img src="/image/github.png" width="30px" height="30px" alt="github">
          </a>
        </div>
        <div class="sns-item">
          <a class="nl" href="https://www.goodreads.com/sambaiz">
            <img src="/image/goodreads.svg" width="30px" height="30px" alt="goodreads">
          </a>
        </div>
        <div class="sns-item">
          <a href="https://filmarks.com/users/sambaiz" class="filmarks" aria-label="filmarks"></a>
        </div>
        <div class="sns-item">
          <a class="nl" href="https://www.google.com/maps/contrib/102687103399829824749/photos">
            <img src="/image/googlemaps.svg" width="30px" height="30px" alt="google maps">
          </a>
        </div>
      </div>
      <div class="tags">
        <div>
          
          <a class="tag" href="/tags/aws/">
            aws</a>
          
          <a class="tag" href="/tags/golang/">
            golang</a>
          
          <a class="tag" href="/tags/machinelearning/">
            machinelearning</a>
          
          <a class="tag" href="/tags/etl/">
            etl</a>
          
          <a class="tag" href="/tags/python/">
            python</a>
          
          <a class="tag" href="/tags/kubernetes/">
            kubernetes</a>
          
          <a class="tag" href="/tags/web/">
            web</a>
          
          <a class="tag" href="/tags/fluentd/">
            fluentd</a>
          
          <a class="tag" href="/tags/gcp/">
            gcp</a>
          
          <a class="tag" href="/tags/ios/">
            ios</a>
          
          <a class="tag others" href="/tags/">...</a>
        </div>
      </div>
    </header>

<div class="container">
  <article class="single">
    <div class="cell">
      <div class="single-header">
        <h1>Express dependencies on past tasks in Airflow</h1>
        <time>2022-11-30</time>
        <a class="tag" href='/en/tags/airflow/'>airflow</a><a class="tag" href='/en/tags/etl/'>etl</a>
      </div>
      <p>If past aggregated values are required for periodic aggregation and such a workflow is simply executed periodically, subsequent processing will fail in a chain reaction when the processing fails or hasn&rsquo;t been completed in time.
Airflow allows you to describe dependencies on past tasks in the following way.
This makes it possible to wait for the past aggregation to finish or to re-execute only dependent tasks collectively in the event of failure.</p>
<h2 id="baseoperatordepends_on_pasthttpsairflowapacheorgdocsapache-airflow243_apiairflowmodelsbaseoperatorindexhtmlairflowmodelsbaseoperatorbaseoperator"><a href="https://airflow.apache.org/docs/apache-airflow/2.4.3/_api/airflow/models/baseoperator/index.html#airflow.models.baseoperator.BaseOperator">BaseOperator.depends_on_past</a></h2>
<p>If set to True, the task won&rsquo;t be executed until the same Task in the past is completed.</p>




<div class="img_container"><a href="/en/article/429/images/depends_on_past.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/en/article/429/images/depends_on_past_hua4a35ad30dce3f71477d7b83dec9d1e6_36527_600x370_fit_lanczos_3.png" width="600" height="194" alt="depends_on_past">
</a></div>


<p>If you set the start_date to the past and enable the DAG, all the time up to the present will be <a href="https://airflow.apache.org/docs/apache-airflow/2.4.3/dag-run.html#catchup">catchuped</a>, so it is easy to see that task3, which takes a long time, is pending execution.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#ff79c6">from</span> airflow <span style="color:#ff79c6">import</span> DAG
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> airflow.operators.dummy <span style="color:#ff79c6">import</span> DummyOperator
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> airflow.operators.bash <span style="color:#ff79c6">import</span> BashOperator
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> airflow.utils.dates <span style="color:#ff79c6">import</span> days_ago
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">with</span> DAG(
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#39;test_depends_on_past&#39;</span>,
</span></span><span style="display:flex;"><span>  start_date<span style="color:#ff79c6">=</span>days_ago(<span style="color:#bd93f9">1</span>),
</span></span><span style="display:flex;"><span>  default_args<span style="color:#ff79c6">=</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#39;depends_on_past&#39;</span>: <span style="color:#ff79c6">True</span>,
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  schedule<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;@hourly&#34;</span>,
</span></span><span style="display:flex;"><span>  catchup<span style="color:#ff79c6">=</span><span style="color:#ff79c6">True</span>
</span></span><span style="display:flex;"><span>) <span style="color:#ff79c6">as</span> dag:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  t1 <span style="color:#ff79c6">=</span> DummyOperator(task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;task1&#39;</span>)
</span></span><span style="display:flex;"><span>  t2 <span style="color:#ff79c6">=</span> DummyOperator(task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;task2&#39;</span>)
</span></span><span style="display:flex;"><span>  t3 <span style="color:#ff79c6">=</span> BashOperator(
</span></span><span style="display:flex;"><span>    task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;task3&#39;</span>,
</span></span><span style="display:flex;"><span>    bash_command<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;sleep 20&#39;</span>,
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  wait_past_t3 <span style="color:#ff79c6">=</span> ExternalTaskSensor(
</span></span><span style="display:flex;"><span>      task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;wait_past_task3&#34;</span>,
</span></span><span style="display:flex;"><span>      external_dag_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;{{ dag.dag_id }}&#39;</span>,
</span></span><span style="display:flex;"><span>      external_task_id<span style="color:#ff79c6">=</span>t3<span style="color:#ff79c6">.</span>task_id,
</span></span><span style="display:flex;"><span>      execution_delta<span style="color:#ff79c6">=</span>timedelta(hours<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span>),
</span></span><span style="display:flex;"><span>      timeout<span style="color:#ff79c6">=</span><span style="color:#bd93f9">600</span>,
</span></span><span style="display:flex;"><span>      allowed_states<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#39;success&#39;</span>],
</span></span><span style="display:flex;"><span>      failed_states<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#39;failed&#39;</span>, <span style="color:#f1fa8c">&#39;skipped&#39;</span>],
</span></span><span style="display:flex;"><span>      mode<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;reschedule&#34;</span>,
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  clear_future_wait_past_t3 <span style="color:#ff79c6">=</span> ExternalTaskMarker(
</span></span><span style="display:flex;"><span>      task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;clear_future_wait_past_task3&#34;</span>,
</span></span><span style="display:flex;"><span>      external_dag_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;{{ dag.dag_id }}&#39;</span>,
</span></span><span style="display:flex;"><span>      external_task_id<span style="color:#ff79c6">=</span>wait_past_t3<span style="color:#ff79c6">.</span>task_id,
</span></span><span style="display:flex;"><span>      execution_date<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;{{ next_execution_date }}&#39;</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  t1 <span style="color:#ff79c6">&gt;&gt;</span> [t2, t3]
</span></span></code></pre></div><h2 id="externaltasksensor-and-externaltaskmarkerhttpsairflowapacheorgdocsapache-airflow243howtooperatorexternal_task_sensorhtml"><a href="https://airflow.apache.org/docs/apache-airflow/2.4.3/howto/operator/external_task_sensor.html">ExternalTaskSensor and ExternalTaskMarker</a></h2>
<p>You can use <a href="https://airflow.apache.org/docs/apache-airflow/2.4.3/_api/airflow/sensors/external_task/index.html#airflow.sensors.external_task.ExternalTaskSensor">ExternalTaskSensor</a> to wait for the completion of another task in the past.
This is also supporting a task in another DAG.</p>




<div class="img_container"><a href="/en/article/429/images/external_task_sensor.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/en/article/429/images/external_task_sensor_hu03483a812443ca8af6cd01c43ed432d4_53503_600x370_fit_lanczos_3.png" width="600" height="228" alt="external_task_sensor">
</a></div>


<p>When <a href="https://airflow.apache.org/docs/apache-airflow/2.4.3/_api/airflow/sensors/external_task/index.html#airflow.sensors.external_task.ExternalTaskMarker">ExternalTaskMarker</a> is cleared with recursive, it clears the status of the target task, and it is re-executed.</p>




<div class="img_container"><a href="/en/article/429/images/external_task_marker.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/en/article/429/images/external_task_marker_hu281008bb5af7597952a122d9365a3aec_147307_600x370_fit_lanczos_3.png" width="600" height="120" alt="external_task_marker">
</a></div>


<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#ff79c6">from</span> datetime <span style="color:#ff79c6">import</span> datetime, timedelta
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> airflow <span style="color:#ff79c6">import</span> DAG
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> airflow.operators.dummy <span style="color:#ff79c6">import</span> DummyOperator
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> airflow.operators.bash <span style="color:#ff79c6">import</span> BashOperator
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> airflow.utils.dates <span style="color:#ff79c6">import</span> days_ago
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> airflow.sensors.external_task <span style="color:#ff79c6">import</span> ExternalTaskSensor, ExternalTaskMarker
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">with</span> DAG(
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#39;test_external_task&#39;</span>,
</span></span><span style="display:flex;"><span>  start_date<span style="color:#ff79c6">=</span>days_ago(<span style="color:#bd93f9">1</span>),
</span></span><span style="display:flex;"><span>  schedule<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;@hourly&#34;</span>,
</span></span><span style="display:flex;"><span>  catchup<span style="color:#ff79c6">=</span><span style="color:#ff79c6">True</span>
</span></span><span style="display:flex;"><span>) <span style="color:#ff79c6">as</span> dag:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  t1 <span style="color:#ff79c6">=</span> DummyOperator(task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;task1&#39;</span>)
</span></span><span style="display:flex;"><span>  t2 <span style="color:#ff79c6">=</span> DummyOperator(task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;task2&#39;</span>)
</span></span><span style="display:flex;"><span>  t3 <span style="color:#ff79c6">=</span> BashOperator(
</span></span><span style="display:flex;"><span>    task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;task3&#39;</span>,
</span></span><span style="display:flex;"><span>    bash_command<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;sleep 20&#39;</span>,
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  wait_past_t3 <span style="color:#ff79c6">=</span> ExternalTaskSensor(
</span></span><span style="display:flex;"><span>    task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;wait_past_task3&#34;</span>,
</span></span><span style="display:flex;"><span>    external_dag_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;{{ dag.dag_id }}&#39;</span>,
</span></span><span style="display:flex;"><span>    external_task_id<span style="color:#ff79c6">=</span>t3<span style="color:#ff79c6">.</span>task_id,
</span></span><span style="display:flex;"><span>    execution_delta<span style="color:#ff79c6">=</span>timedelta(hours<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span>),
</span></span><span style="display:flex;"><span>    timeout<span style="color:#ff79c6">=</span><span style="color:#bd93f9">600</span>,
</span></span><span style="display:flex;"><span>    allowed_states<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#39;success&#39;</span>],
</span></span><span style="display:flex;"><span>    failed_states<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#39;failed&#39;</span>, <span style="color:#f1fa8c">&#39;skipped&#39;</span>],
</span></span><span style="display:flex;"><span>    mode<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;reschedule&#34;</span>,
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  clear_future_wait_past_t3 <span style="color:#ff79c6">=</span> ExternalTaskMarker(
</span></span><span style="display:flex;"><span>    task_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;clear_future_wait_past_task3&#34;</span>,
</span></span><span style="display:flex;"><span>    external_dag_id<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;{{ dag.dag_id }}&#39;</span>,
</span></span><span style="display:flex;"><span>    external_task_id<span style="color:#ff79c6">=</span>wait_past_t3<span style="color:#ff79c6">.</span>task_id,
</span></span><span style="display:flex;"><span>    execution_date<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;{{ next_execution_date }}&#39;</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  t1 <span style="color:#ff79c6">&gt;&gt;</span> [t2, t3]
</span></span><span style="display:flex;"><span>  wait_past_t3 <span style="color:#ff79c6">&gt;&gt;</span> t2
</span></span><span style="display:flex;"><span>  t3 <span style="color:#ff79c6">&gt;&gt;</span> clear_future_wait_past_t3
</span></span></code></pre></div>
    </div>
    <div class="share">
      <div class="cell">
        <div>share</div>
        <div>
          <a class="share-button" href='https://twitter.com/intent/tweet?url=https://www.sambaiz.net/en/article/429/&text=Express%20dependencies%20on%20past%20tasks%20in%20Airflow%20-%20sambaiz-net'>
            <img src="/image/twitter.png" width="40px" height="40px" alt="twitter">
          </a>
          <a href="https://b.hatena.ne.jp/entry/" class="share-button hatena-bookmark-button" data-hatena-bookmark-layout="touch" data-hatena-bookmark-width="40" data-hatena-bookmark-height="40" title="このエントリーをはてなブックマークに追加">
            <img src="https://b.st-hatena.com/images/v4/public/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="40" height="40" style="border: none;" />
          </a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
        </div>
      </div>
    </div>
  </article>
</div>

</div>
</body>

</html>