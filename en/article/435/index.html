<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NCML2RV');</script>
  

  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
  <link rel="stylesheet" href="/css/destyle.css">
  <style>
    body {
        background-color: #f1f1f1;
        line-height: 1.3;
        
        font-family: "Helvetica Neue", 
            Arial, 
            "Hiragino Kaku Gothic ProN",
            "Hiragino Sans",
            "BIZ UDPGothic",
            Meiryo,
            sans-serif;
    }

    table {
        margin-block-start: 1.5rem;
        margin-block-end: 1.5rem;
    }

    table th,table td{
        padding: 0.2rem 1.0rem;
    }

    table tr{
        border-bottom: solid 1px #eee;
    }

    .languages {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 1.2rem;
        color: #3a9240;
    }

    header {
        margin-block-start: 1.875rem;
        margin-block-end: 1.875rem;
    }

    header>.title {
        font-size: 1.875rem;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .sns {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .sns-item {
        display: inline-block;
        margin: 3px;
    }

    .filmarks {
        display: inline-block;
        width: 32px;
        height: 32px;
        margin-top: 3px;
        background: url(/image/filmarks.svg) no-repeat;
        background-size: 450%;
    }

    header>.tags {
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.2rem;
        max-width: 1000px;
        margin: auto;
        padding: 0 20px;
    }

    header>.tags .others {
        font-weight: bold;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .nl {
        display: inline-block;
    }

    .cell {
        background-color: #fff;
        border-radius: 5px;
        padding: 10px;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.1) inset;
    }

    time {
        color: #333;
    }

    .tag {
        color: #3a9240;
        margin: 0 5px;
    }

    .tag:hover {
        text-decoration: underline;
    }

     
    .paging {
        display: inline-block;
        font-size: 1.25rem;
        margin: 10px 10px;
    }

    .paging.next {
        float: right;
    }


     
    .list>.title {
        font-size: 1.75rem;
        margin: 0 0 10px 10px;
    }

     
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(262px, 1fr));
        gap: 20px;
        margin: 0 10px;
    }

    .grid-nl {
        width: 100%;
    }

    .grid-cell {
        height: 11.25rem;
        overflow: hidden;
        box-sizing: content-box;
    }

    .grid-cell>.title {
        font-size: 1.4rem;
        word-wrap: break-word;
    }

     
    .single {
        margin: 0 10px 10px 10px;
        line-height: 1.5;
    }

    @media screen and (min-width: 768px) {
        .single .cell {
            padding: 10px 20px;
        }
    }

    .single-header {
        margin-block-start: 1.875rem;
        margin-block-end: 1.875rem;
        line-height: 1.3;
    }

    .single-header h1 {
        font-size: 2rem;
        font-weight: bold;
    }

    .single h2 {
        font-size: 1.8rem;
        border-bottom: 1px solid #ddd;
        margin-block-start: 1.875rem;
    }

    .single h3 {
        font-size: 1.5rem;
        margin-block-start: 1.5rem;
    }

    .single h4 {
        font-size: 1.2rem;
        margin-block-start: 1rem;
    }

    .single a {
        color: #3a9240;
    }

    .single a:hover {
        text-decoration: underline;
    }

    .single p {
        margin-block-start: 0.83rem;
        margin-block-end: 0.83rem;
    }

    code {
        
        font-family: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;
    }

    .single p>code, .single li>code {
        padding: 0 0.2rem;
        display: inline-block;
        overflow: auto;
        max-width: 100%;
        vertical-align: bottom;
    }

    .single strong {
        color: #d2691e;
        font-weight: normal;
    }

    .single .highlight {
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.1) inset;
        margin-block-start: 1rem;
        margin-block-end: 1rem;
        font-size: 0.875rem;
    }

    .single .img_container {
        margin-block-start: 0.1rem;
        margin-block-end: 0.1rem;
        text-align: center;
    }

    .single img {
        border: 1px solid #ddd;
    }

    .single .highlight>pre {
        padding: 10px;
        overflow-x: auto;
    }

    .single img {
        max-width: 100%;
    }

    .single blockquote {
        border-left: 5px solid #ddd;
        color: #777;
        padding: 1rem 0 1rem 1rem;
        margin-block-start: 0.83rem;
        margin-block-end: 0.83rem;
    }

    .single blockquote > p {
        margin-block-start: 0;
        margin-block-end: 0;
    }

    .single hr {
        color: #bbb;
        margin-block-start: 1.5rem;
        margin-block-end: 1.5rem;
    }

    .single ul {
        list-style-type: disc;
        padding-left: 1.5em;
        margin-block-end: 0.4rem;
    }
</style>
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://www.sambaiz.net/index.xml">
  <link rel="icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">

  <meta name="theme-color" content="#41a248">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@sambaiz">
  
  <title>Benchmark Java codes with JMH - sambaiz-net</title>
  <meta name="twitter:title" content="Benchmark Java codes with JMH - sambaiz-net">
  <meta property='og:title' content="Benchmark Java codes with JMH - sambaiz-net">
  <meta property="og:type" content="article">
  
  <meta name="description" content="it can small codes&#39; benchmark accurately">
  <meta name="twitter:description" content="it can small codes&#39; benchmark accurately">
  
  

  <meta property="og:url" content="https://www.sambaiz.net/en/article/435/">
  <meta property="og:image" content="https://www.sambaiz.net/images/my_l.jpg">
  <meta name="twitter:image" content="https://www.sambaiz.net/images/my.jpg" />

  
  
  <link rel="alternate" hreflang="ja" href="https://www.sambaiz.net/article/435/" />
  
  <link rel="alternate" hreflang="x-default" href="https://www.sambaiz.net/article/435/" />
  
  
  <link rel="alternate" hreflang="en" href="https://www.sambaiz.net/en/article/435/" />
  
  
  

  
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id": "https://www.sambaiz.net/"
    },
    "headline": "Benchmark Java codes with JMH",
    "datePublished": "2023-01-28T17:48:00JST",
    "dateModified": "2023-01-28T17:48:00JST",
    "author": {
      "@type": "Person",
      "name": "sambaiz",
      "url": "https://www.sambaiz.net/",
      "image": "https://www.sambaiz.net/images/my.jpg"
    },
    "publisher": {
      "@type": "Person",
      "name": "sambaiz-net",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.sambaiz.net/images/my.jpg",
        "height": 60,
        "width": 60
      }
    },
    "image": {
      "@type": "ImageObject",
      "url": "https://www.sambaiz.net/images/my.jpg",
      "height": 138,
      "width": 138
    },
    "description": "it can small codes' benchmark accurately"
  }
</script>
</head>

<body>
  
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCML2RV"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <div>
    <div class="languages">
      
      <ul>
          
          <li>
              <a href="https://www.sambaiz.net/article/435/">日本語</a>
          </li>
          
      </ul>
      
    </div>

    <header>
      <div class="title">
        <img src="https://www.sambaiz.net/images/my.png" width="60px" height="60px" alt="icon" />
        <a class="nl" href='/en/'>
          <h1>sambaiz-net</h1>
        </a>
      </div>

      <div class="sns">
        <div class="sns-item">
          <a class="nl" href="https://github.com/sambaiz">
            <img src="/image/github.png" width="30px" height="30px" alt="github">
          </a>
        </div>
        <div class="sns-item">
          <a class="nl" href="https://www.google.com/maps/contrib/102687103399829824749/photos">
            <img src="/image/googlemaps.svg" width="30px" height="30px" alt="google maps">
          </a>
        </div>
        <div class="sns-item">
          <a class="nl" href="https://boardgamearena.com/player?id=83835726">
            <img src="/image/boardgamearena.webp" width="30px" height="30px" alt="board game arena">
          </a>
        </div>
      </div>
      <div class="tags">
        <div>
          
          <a class="tag" href="/tags/aws/">
            aws</a>
          
          <a class="tag" href="/tags/golang/">
            golang</a>
          
          <a class="tag" href="/tags/machinelearning/">
            machinelearning</a>
          
          <a class="tag" href="/tags/etl/">
            etl</a>
          
          <a class="tag" href="/tags/python/">
            python</a>
          
          <a class="tag" href="/tags/kubernetes/">
            kubernetes</a>
          
          <a class="tag" href="/tags/web/">
            web</a>
          
          <a class="tag" href="/tags/fluentd/">
            fluentd</a>
          
          <a class="tag" href="/tags/gcp/">
            gcp</a>
          
          <a class="tag" href="/tags/ios/">
            ios</a>
          
          <a class="tag others" href="/tags/">...</a>
        </div>
      </div>
    </header>

<div class="container">
  <article class="single">
    <div class="cell">
      <div class="single-header">
        <h1>Benchmark Java codes with JMH</h1>
        <time>2023-01-28</time>
        <a class="tag" href='/en/tags/java/'>java</a>
      </div>
      <p><a href="https://github.com/openjdk/jmh">JMH (Java Microbenchmark Harness)</a> is a benchmark tool for JVM languages.
If you execute small codes naively, the performance can be better than actual due to optimization such as JIT compile that is not performed in the real case that whole codes are large.
JMH prevent the optimization from being applied, so it seems that it can benchmark accurately.</p>
<p>Create a project according to the README and try to run the benchmark.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ mvn archetype:generate <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>  -DinteractiveMode<span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">false</span> <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>  -DarchetypeGroupId<span style="color:#ff79c6">=</span>org.openjdk.jmh <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>  -DarchetypeArtifactId<span style="color:#ff79c6">=</span>jmh-java-benchmark-archetype <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>  -DgroupId<span style="color:#ff79c6">=</span>org.sample <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>  -DartifactId<span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">test</span> <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span>  -Dversion<span style="color:#ff79c6">=</span>1.0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ tree
</span></span><span style="display:flex;"><span>    .
</span></span><span style="display:flex;"><span>├── aaaa
</span></span><span style="display:flex;"><span>└── <span style="color:#8be9fd;font-style:italic">test</span>
</span></span><span style="display:flex;"><span>    ├── pom.xml
</span></span><span style="display:flex;"><span>    └── src
</span></span><span style="display:flex;"><span>        └── main
</span></span><span style="display:flex;"><span>            └── java
</span></span><span style="display:flex;"><span>                └── org
</span></span><span style="display:flex;"><span>                    └── sample
</span></span><span style="display:flex;"><span>                        └── MyBenchmark.java
</span></span><span style="display:flex;"><span>           
</span></span><span style="display:flex;"><span>$ mvn clean verify
</span></span><span style="display:flex;"><span>$ java -jar target/benchmarks.jar
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Benchmark mode: Throughput, ops/time</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Benchmark: org.sample.MyBenchmark.testMethod</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Run progress: 0.00% complete, ETA 00:08:20</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Fork: 1 of 5</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Warmup Iteration   1: 3341043347.302 ops/s</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Warmup Iteration   2: 3413334610.874 ops/s</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Warmup Iteration   3: 3435333707.240 ops/s</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Warmup Iteration   4: 3411134300.511 ops/s</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Warmup Iteration   5: 3357532714.229 ops/s</span>
</span></span><span style="display:flex;"><span>Iteration   1: 3400156491.349 ops/s
</span></span><span style="display:flex;"><span>Iteration   2: 3386226994.749 ops/s
</span></span><span style="display:flex;"><span>Iteration   3: 3447242449.844 ops/s
</span></span><span style="display:flex;"><span>Iteration   4: 3445778472.937 ops/s
</span></span><span style="display:flex;"><span>Iteration   5: 3445982939.981 ops/s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Run progress: 20.00% complete, ETA 00:06:41</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Fork: 2 of 5</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Benchmark                Mode  Cnt           Score          Error  Units
</span></span><span style="display:flex;"><span>MyBenchmark.testMethod  thrpt   <span style="color:#bd93f9">25</span>  3392960046.446 ± 27900374.591  ops/s
</span></span></code></pre></div><p>Annotate @Benchmark to the method, run @BenchmarkMode benchmarks, and output with @OutputTimeUnit unit.
Benchmarks can have states with @State and @Setup(Level.Trial) initializes it only once per fork.
You can return values or pass them to Blackhole.consume() to avoid getting rid of codes due to dead codes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> org.sample<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> org.openjdk.jmh.annotations.*<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> org.openjdk.jmh.infra.Blackhole<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.concurrent.TimeUnit<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">MyBenchmark2</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @State<span style="color:#ff79c6">(</span>Scope<span style="color:#ff79c6">.</span><span style="color:#50fa7b">Thread</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">MyState</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">int</span> v<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Benchmark
</span></span><span style="display:flex;"><span>    @BenchmarkMode<span style="color:#ff79c6">(</span>Mode<span style="color:#ff79c6">.</span><span style="color:#50fa7b">AverageTime</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    @OutputTimeUnit<span style="color:#ff79c6">(</span>TimeUnit<span style="color:#ff79c6">.</span><span style="color:#50fa7b">MICROSECONDS</span><span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">some</span><span style="color:#ff79c6">(</span>Blackhole blackhole<span style="color:#ff79c6">,</span> MyState state<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">{</span>
</span></span><span style="display:flex;"><span>        state<span style="color:#ff79c6">.</span><span style="color:#50fa7b">v</span> <span style="color:#ff79c6">=</span> state<span style="color:#ff79c6">.</span><span style="color:#50fa7b">v</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">-</span>1 <span style="color:#ff79c6">+</span> 1<span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        String notusedValue <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&#34;</span> <span style="color:#ff79c6">+</span> state<span style="color:#ff79c6">.</span><span style="color:#50fa7b">v</span><span style="color:#ff79c6">;</span>
</span></span><span style="display:flex;"><span>        blackhole<span style="color:#ff79c6">.</span><span style="color:#50fa7b">consume</span><span style="color:#ff79c6">(</span>notusedValue<span style="color:#ff79c6">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">}</span>
</span></span></code></pre></div><p>The required dependencies are the following two.
Uber-jar including <a href="https://github.com/openjdk/jmh/blob/1.36/jmh-core/src/main/java/org/openjdk/jmh/Main.java">org.openjdk.jmh.Main</a> as a main class is built.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;groupId&gt;</span>org.openjdk.jmh<span style="color:#ff79c6">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;artifactId&gt;</span>jmh-core<span style="color:#ff79c6">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;version&gt;</span>${jmh.version}<span style="color:#ff79c6">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;groupId&gt;</span>org.openjdk.jmh<span style="color:#ff79c6">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;artifactId&gt;</span>jmh-generator-annprocess<span style="color:#ff79c6">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;version&gt;</span>${jmh.version}<span style="color:#ff79c6">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;scope&gt;</span>provided<span style="color:#ff79c6">&lt;/scope&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/dependencies&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;groupId&gt;</span>org.apache.maven.plugins<span style="color:#ff79c6">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;artifactId&gt;</span>maven-shade-plugin<span style="color:#ff79c6">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;version&gt;</span>3.2.1<span style="color:#ff79c6">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;executions&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;execution&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;phase&gt;</span>package<span style="color:#ff79c6">&lt;/phase&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;goals&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;goal&gt;</span>shade<span style="color:#ff79c6">&lt;/goal&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/goals&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;finalName&gt;</span>${uberjar.name}<span style="color:#ff79c6">&lt;/finalName&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;transformers&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;transformer</span> <span style="color:#50fa7b">implementation=</span><span style="color:#f1fa8c">&#34;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;mainClass&gt;</span>org.openjdk.jmh.Main<span style="color:#ff79c6">&lt;/mainClass&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/transformer&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;transformer</span> <span style="color:#50fa7b">implementation=</span><span style="color:#f1fa8c">&#34;org.apache.maven.plugins.shade.resource.ServicesResourceTransformer&#34;</span><span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/transformers&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;filters&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;filter&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#6272a4">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                            Shading signed JARs will fail without this.
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                            http://stackoverflow.com/questions/999489/invalid-signature-file-when-attempting-to-run-a-jar
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">                        --&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;artifact&gt;</span>*:*<span style="color:#ff79c6">&lt;/artifact&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;excludes&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ff79c6">&lt;exclude&gt;</span>META-INF/*.SF<span style="color:#ff79c6">&lt;/exclude&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ff79c6">&lt;exclude&gt;</span>META-INF/*.DSA<span style="color:#ff79c6">&lt;/exclude&gt;</span>
</span></span><span style="display:flex;"><span>                            <span style="color:#ff79c6">&lt;exclude&gt;</span>META-INF/*.RSA<span style="color:#ff79c6">&lt;/exclude&gt;</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#ff79c6">&lt;/excludes&gt;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ff79c6">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">&lt;/filters&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/execution&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/executions&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/plugin&gt;</span>
</span></span></code></pre></div><p>Or, you can call it directly with passing classpath.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#6272a4">&lt;!-- mvn exec:exec --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;groupId&gt;</span>org.codehaus.mojo<span style="color:#ff79c6">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;artifactId&gt;</span>exec-maven-plugin<span style="color:#ff79c6">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;version&gt;</span>3.1.0<span style="color:#ff79c6">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;executable&gt;</span>java<span style="color:#ff79c6">&lt;/executable&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;arguments&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;argument&gt;</span>-classpath<span style="color:#ff79c6">&lt;/argument&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;classpath</span> <span style="color:#ff79c6">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;argument&gt;</span>org.openjdk.jmh.Main<span style="color:#ff79c6">&lt;/argument&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/arguments&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/plugin&gt;</span>
</span></span></code></pre></div><h2 id="references">References</h2>
<p><a href="https://jenkov.com/tutorials/java-performance/jmh.html">JMH - Java Microbenchmark Harness</a></p>

    </div>
  </article>
</div>

</div>
</body>

</html>