<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NCML2RV');</script>
  

  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
  <link rel="stylesheet" href="/css/destyle.css">
  <style>
    body {
        background-color: #f1f1f1;
        line-height: 1.3;
        
        font-family: "Helvetica Neue", 
            Arial, 
            "Hiragino Kaku Gothic ProN",
            "Hiragino Sans",
            "BIZ UDPGothic",
            Meiryo,
            sans-serif;
    }

    table {
        margin-block-start: 1.5rem;
        margin-block-end: 1.5rem;
    }

    table th,table td{
        padding: 0.2rem 1.0rem;
    }

    table tr{
        border-bottom: solid 1px #eee;
    }

    .languages {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 1.2rem;
        color: #3a9240;
    }

    header {
        margin-block-start: 1.875rem;
        margin-block-end: 1.875rem;
    }

    header>.title {
        font-size: 1.875rem;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .sns {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .sns-item {
        display: inline-block;
        margin: 3px;
    }

    .filmarks {
        display: inline-block;
        width: 30px;
        height: 30px;
        margin-top: 3px;
        background: url(/image/filmarks.svg) no-repeat;
        background-size: 450%;
    }

    header>.tags {
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.2rem;
        max-width: 1000px;
        margin: auto;
        padding: 0 20px;
    }

    header>.tags .others {
        font-weight: bold;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .nl {
        display: inline-block;
    }

    .cell {
        background-color: #fff;
        border-radius: 5px;
        padding: 10px;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.1) inset;
    }

    time {
        color: #333;
    }

    .tag {
        color: #3a9240;
        margin: 0 5px;
    }

    .tag:hover {
        text-decoration: underline;
    }

     
    .paging {
        display: inline-block;
        font-size: 1.25rem;
        margin: 10px 10px;
    }

    .paging.next {
        float: right;
    }


     
    .list>.title {
        font-size: 1.75rem;
        margin: 0 0 10px 10px;
    }

     
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(262px, 1fr));
        gap: 20px;
        margin: 0 10px;
    }

    .grid-nl {
        width: 100%;
    }

    .grid-cell {
        height: 11.25rem;
        overflow: hidden;
        box-sizing: content-box;
    }

    .grid-cell>.title {
        font-size: 1.4rem;
        word-wrap: break-word;
    }

     
    .single {
        margin: 0 10px 10px 10px;
        line-height: 1.5;
    }

    @media screen and (min-width: 768px) {
        .single .cell {
            padding: 10px 20px;
        }
    }

    .single-header {
        margin-block-start: 1.875rem;
        margin-block-end: 1.875rem;
        line-height: 1.3;
    }

    .single-header h1 {
        font-size: 2rem;
        font-weight: bold;
    }

    .single h2 {
        font-size: 1.8rem;
        border-bottom: 1px solid #ddd;
        margin-block-start: 1.875rem;
    }

    .single h3 {
        font-size: 1.5rem;
        margin-block-start: 1.5rem;
    }

    .single h4 {
        font-size: 1.2rem;
        margin-block-start: 1rem;
    }

    .single a {
        color: #3a9240;
    }

    .single a:hover {
        text-decoration: underline;
    }

    .single p {
        margin-block-start: 0.83rem;
        margin-block-end: 0.83rem;
    }

    code {
        
        font-family: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;
    }

    .single p>code, .single li>code {
        padding: 0 0.2rem;
        display: inline-block;
        overflow: auto;
        max-width: 100%;
        vertical-align: bottom;
    }

    .single strong {
        color: #d2691e;
        font-weight: normal;
    }

    .single .highlight {
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.1) inset;
        margin-block-start: 1rem;
        margin-block-end: 1rem;
        font-size: 0.875rem;
    }

    .single .img_container {
        margin-block-start: 0.1rem;
        margin-block-end: 0.1rem;
        text-align: center;
    }

    .single img {
        border: 1px solid #ddd;
    }

    .share-button > img {
        border: none;
    }

    .single .highlight>pre {
        padding: 10px;
        overflow-x: auto;
    }

    .single img {
        max-width: 100%;
    }

    .single blockquote {
        border-left: 5px solid #ddd;
        color: #777;
        padding: 1rem 0 1rem 1rem;
        margin-block-start: 0.83rem;
        margin-block-end: 0.83rem;
    }

    .single blockquote > p {
        margin-block-start: 0;
        margin-block-end: 0;
    }

    .single hr {
        color: #bbb;
        margin-block-start: 1.5rem;
        margin-block-end: 1.5rem;
    }

    .single ul {
        list-style-type: disc;
        padding-left: 1.5em;
        margin-block-start: 0.83rem;
        margin-block-end: 0.83rem;
    }

    .share {
        position: relative;
        text-align: right;
        margin-top: 5px;
    }

    .share .cell {
        display: inline-block;
        text-align: center;
        margin-bottom: 5px;
    }

    .share-button {
        display: inline-block;
        margin: 0 5px;
    }

    @media screen and (min-width: 1400px) {
        .share .cell {
            position: absolute;
            bottom: 0;
            margin-left: 5px;
        }

        .share-button {
            display: inline-block;
            margin: 5px 0;
        }
    }
</style>
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://www.sambaiz.net/index.xml">
  <link rel="icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">

  <meta name="theme-color" content="#41a248">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@sambaiz">
  
  <title>Run a Spark application with Amzon EMR - sambaiz-net</title>
  <meta name="twitter:title" content="Run a Spark application with Amzon EMR - sambaiz-net">
  <meta property='og:title' content="Run a Spark application with Amzon EMR - sambaiz-net">
  <meta property="og:type" content="article">
  
  <meta name="description" content="launches a cluster running Spark, Hive, and Presto apps on EC2 or EKS">
  <meta name="twitter:description" content="launches a cluster running Spark, Hive, and Presto apps on EC2 or EKS">
  
  

  <meta property="og:url" content="https://www.sambaiz.net/en/article/409/">
  <meta property="og:image" content="https://www.sambaiz.net/images/my_l.jpg">
  <meta name="twitter:image" content="https://www.sambaiz.net/images/my.jpg" />

  
  
  <link rel="alternate" hreflang="ja" href="https://www.sambaiz.net/article/409/" />
  
  <link rel="alternate" hreflang="x-default" href="https://www.sambaiz.net/article/409/" />
  
  
  <link rel="alternate" hreflang="en" href="https://www.sambaiz.net/en/article/409/" />
  
  
  

  
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id": "https://www.sambaiz.net/"
    },
    "headline": "Run a Spark application with Amzon EMR",
    "datePublished": "2022-06-22T00:05:00JST",
    "dateModified": "2022-06-22T00:05:00JST",
    "author": {
      "@type": "Person",
      "name": "sambaiz",
      "url": "https://www.sambaiz.net/",
      "image": "https://www.sambaiz.net/images/my.jpg"
    },
    "publisher": {
      "@type": "Person",
      "name": "sambaiz-net",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.sambaiz.net/images/my.jpg",
        "height": 60,
        "width": 60
      }
    },
    "image": {
      "@type": "ImageObject",
      "url": "https://www.sambaiz.net/images/my.jpg",
      "height": 138,
      "width": 138
    },
    "description": "launches a cluster running Spark, Hive, and Presto apps on EC2 or EKS"
  }
</script>
</head>

<body>
  
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCML2RV"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <div>
    <div class="languages">
      
      <ul>
          
          <li>
              <a href="https://www.sambaiz.net/article/409/">日本語</a>
          </li>
          
      </ul>
      
    </div>

    <header>
      <div class="title">
        <img src="https://www.sambaiz.net/images/my.png" width="60px" height="60px" alt="icon" />
        <a class="nl" href='/en/'>
          <h1>sambaiz-net</h1>
        </a>
      </div>

      <div class="sns">
        <div class="sns-item">
          <a class="nl" href="https://github.com/sambaiz">
            <img src="/image/github.png" width="30px" height="30px" alt="github">
          </a>
        </div>
        <div class="sns-item">
          <a class="nl" href="https://www.goodreads.com/sambaiz">
            <img src="/image/goodreads.svg" width="30px" height="30px" alt="goodreads">
          </a>
        </div>
        <div class="sns-item">
          <a href="https://filmarks.com/users/sambaiz" class="filmarks" aria-label="filmarks"></a>
        </div>
      </div>
      <div class="tags">
        <div>
          
          <a class="tag" href="/tags/aws/">
            aws</a>
          
          <a class="tag" href="/tags/golang/">
            golang</a>
          
          <a class="tag" href="/tags/machinelearning/">
            machinelearning</a>
          
          <a class="tag" href="/tags/log/">
            log</a>
          
          <a class="tag" href="/tags/python/">
            python</a>
          
          <a class="tag" href="/tags/kubernetes/">
            kubernetes</a>
          
          <a class="tag" href="/tags/docker/">
            docker</a>
          
          <a class="tag" href="/tags/infra/">
            infra</a>
          
          <a class="tag" href="/tags/fluentd/">
            fluentd</a>
          
          <a class="tag" href="/tags/gcp/">
            gcp</a>
          
          <a class="tag others" href="/tags/">...</a>
        </div>
      </div>
    </header>

<div class="container">
  <article class="single">
    <div class="cell">
      <div class="single-header">
        <h1>Run a Spark application with Amzon EMR</h1>
        <time>2022-06-22</time>
        <a class="tag" href='/en/tags/aws/'>aws</a><a class="tag" href='/en/tags/spark/'>spark</a><a class="tag" href='/en/tags/hadoop/'>hadoop</a>
      </div>
      <p><a href="https://aws.amazon.com/jp/emr/">Amazon EMR</a> is the service that launches a cluster running Spark, Hive, and Presto apps on EC2 or EKS. While Glue, the managed Spark service, can easily run Spark ETL jobs with serverless, EMR has the advantage of excellent cost performance, and also fine-tuning is available, but now that <a href="https://aws.amazon.com/jp/emr/serverless/">EMR Serverless</a> has been released, the difference has narrowed a little. Glue also has handy features such as Connector, which makes various data sources referrable, and Bookmark, which makes processing being executed from the previous continuation. However, if heavy processing is executed repeatedly, it can be expensive, besides, it causes to reach quotas such as DPU, so it would be better to use it properly.</p>
<p><a href="https://www.sambaiz.net/en/article/393/">Generate data with TPC-DS Connector for Glue - sambaiz-net</a></p>
<p><a href="https://www.sambaiz.net/en/article/333/">Enable Job Bookmark of AWS Glue to process from the records following ones executed previously - sambaiz-net</a></p>
<p>I use the following code this time.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">$ cat test<span style="color:#ff79c6">.</span>py
<span style="color:#ff79c6">import</span> argparse
<span style="color:#ff79c6">import</span> logging

<span style="color:#ff79c6">from</span> pyspark.sql <span style="color:#ff79c6">import</span> SparkSession

logger <span style="color:#ff79c6">=</span> logging<span style="color:#ff79c6">.</span>getLogger(__name__)
logging<span style="color:#ff79c6">.</span>basicConfig(level<span style="color:#ff79c6">=</span>logging<span style="color:#ff79c6">.</span>INFO, format<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">%(levelname)s</span><span style="color:#f1fa8c">: </span><span style="color:#f1fa8c">%(message)s</span><span style="color:#f1fa8c">&#39;</span>)

output_path <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;s3://&lt;bucket&gt;/emrtest/&#34;</span>

<span style="color:#ff79c6">if</span> __name__ <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#34;__main__&#34;</span>:
  parser <span style="color:#ff79c6">=</span> argparse<span style="color:#ff79c6">.</span>ArgumentParser()
  parser<span style="color:#ff79c6">.</span>add_argument(<span style="color:#f1fa8c">&#39;--value&#39;</span>, default<span style="color:#ff79c6">=</span><span style="color:#bd93f9">10</span>, <span style="color:#8be9fd;font-style:italic">type</span><span style="color:#ff79c6">=</span><span style="color:#8be9fd;font-style:italic">int</span>, help<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;some value&#34;</span>)
  args <span style="color:#ff79c6">=</span> parser<span style="color:#ff79c6">.</span>parse_args()
  <span style="color:#ff79c6">with</span> SparkSession<span style="color:#ff79c6">.</span>builder<span style="color:#ff79c6">.</span>appName(<span style="color:#f1fa8c">&#34;testapp&#34;</span>)<span style="color:#ff79c6">.</span>getOrCreate() <span style="color:#ff79c6">as</span> spark:
    df <span style="color:#ff79c6">=</span> spark<span style="color:#ff79c6">.</span>createDataFrame([(args<span style="color:#ff79c6">.</span>value,)], [<span style="color:#f1fa8c">&#39;value&#39;</span>])
    logger<span style="color:#ff79c6">.</span>info(<span style="color:#f1fa8c">&#34;write </span><span style="color:#f1fa8c">%d</span><span style="color:#f1fa8c"> rows&#34;</span>, df<span style="color:#ff79c6">.</span>count())
    df<span style="color:#ff79c6">.</span>write<span style="color:#ff79c6">.</span>mode(<span style="color:#f1fa8c">&#39;overwrite&#39;</span>)<span style="color:#ff79c6">.</span>parquet(output_path, compression<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;gzip&#34;</span>)

$ aws s3 cp test<span style="color:#ff79c6">.</span>py s3:<span style="color:#ff79c6">//&lt;</span>bucket<span style="color:#ff79c6">&gt;/</span>
</code></pre></div><p>IF tables in Glue Data Catalog is referred,
To refer to the Glue Data Catalog table, apply <a href="https://docs.aws.amazon.com/ja_jp/emr/latest/ReleaseGuide/emr-spark-glue.html">the following settings</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-python" data-lang="python"><span style="color:#ff79c6">with</span> SparkSession<span style="color:#ff79c6">.</span>builder \
    <span style="color:#ff79c6">.</span>appName(<span style="color:#f1fa8c">&#34;testapp&#34;</span>) \
    <span style="color:#ff79c6">.</span>config(<span style="color:#f1fa8c">&#34;hive.metastore.client.factory.class&#34;</span>, <span style="color:#f1fa8c">&#34;com.amazonaws.glue.catalog.metastore.AWSGlueDataCatalogHiveClientFactory&#34;</span>) \
    <span style="color:#ff79c6">.</span>enableHiveSupport() \
    <span style="color:#ff79c6">.</span>getOrCreate() <span style="color:#ff79c6">as</span> spark:
    df <span style="color:#ff79c6">=</span> spark<span style="color:#ff79c6">.</span>sql(<span style="color:#f1fa8c">&#34;SELECT * FROM xxxx.yyyyy&#34;</span>)
</code></pre></div><p>Besides, if there is a partition whose type is Date, &ldquo;Unsupported expression &lsquo;2022 - 05 - 04&rsquo;&rdquo; error <a href="https://github.com/awslabs/aws-glue-data-catalog-client-for-apache-hive-metastore/issues/45">occurs</a>, so it needs to disable partition pruning.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-python" data-lang="python"><span style="color:#ff79c6">.</span>config(<span style="color:#f1fa8c">&#34;spark.sql.hive.metastorePartitionPruning&#34;</span>, <span style="color:#f1fa8c">&#34;false&#34;</span>) \
</code></pre></div><p><a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/emr/create-cluster.html">aws emr create-cluster</a> launches a cluster. If &ndash;step and &ndash;auto-terminate are passed, the cluster will be terminated as soon as the process is completed, so it can be disposable.</p>
<p>Other flags are as follows:</p>
<ul>
<li>&ndash;release-label emr-6.3.1: <a href="https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-release-components.html">EMR version</a>. This version runs the same Spark 3.1.1 as Glue 3.0.</li>
<li>&ndash;applications Name=Spark: Installed applications</li>
<li>&ndash;instance-type, &ndash;instance-count: <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-supported-instance-types.html">Instance type</a> and the number. One of these is the Master node and the rest are the Core node.</li>
<li>&ndash;use-default-roles: Use EMR_EC2_DefaultRole as the instance profile, and EMR_DefaultRole as the EMR role.</li>
<li>&ndash;enable-debugging, &ndash;log-uri: Make logs visible from the console</li>
<li>&ndash;name: Cluster name. The default is &ldquo;Development Cluster&rdquo;</li>
</ul>
<p><a href="https://spark.apache.org/docs/latest/submitting-applications.html">spark-submit</a> is passed:</p>
<ul>
<li>&ndash;master yarn: <a href="https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/YARN.html">YARN</a>, Use YARN, the resource manager of Hadoop, as a Cluster Manager.</li>
<li><a href="https://spark.apache.org/docs/latest/cluster-overview.html">&ndash;deploy-mode</a>: Whether to execute the Driver Program that generates SparkContext on the client or in the cluster managed by Cluster Manager.
In EMR, if it is set to &ldquo;client&rdquo;, the Driver Program is <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-studio-spark-optimization.html">executed</a> on the Master node, and if it is set to &ldquo;cluster&rdquo;, the Driver Program executed on the Core node.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-sh" data-lang="sh">$ aws emr create-cluster <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --release-label emr-6.3.1 <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --applications <span style="color:#8be9fd;font-style:italic">Name</span><span style="color:#ff79c6">=</span>Spark <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --instance-type m6g.xlarge <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --instance-count <span style="color:#bd93f9">3</span> <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --use-default-roles <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --auto-terminate <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --enable-debugging <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --log-uri s3n://&lt;bucket&gt;/emrlogs/ <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --name <span style="color:#8be9fd;font-style:italic">test</span> <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>  --steps <span style="color:#f1fa8c">&#39;[{
</span><span style="color:#f1fa8c">    &#34;Type&#34;: &#34;CUSTOM_JAR&#34;,
</span><span style="color:#f1fa8c">    &#34;Name&#34;: &#34;spark-submit&#34;,
</span><span style="color:#f1fa8c">    &#34;ActionOnFailure&#34;: &#34;TERMINATE_CLUSTER&#34;,
</span><span style="color:#f1fa8c">    &#34;Jar&#34;: &#34;command-runner.jar&#34;, 
</span><span style="color:#f1fa8c">    &#34;Args&#34;: [
</span><span style="color:#f1fa8c">      &#34;spark-submit&#34;,
</span><span style="color:#f1fa8c">      &#34;--master&#34;,
</span><span style="color:#f1fa8c">      &#34;yarn&#34;,
</span><span style="color:#f1fa8c">      &#34;--deploy-mode&#34;,
</span><span style="color:#f1fa8c">      &#34;client&#34;,
</span><span style="color:#f1fa8c">      &#34;s3://&lt;bucket&gt;/test.py&#34;,
</span><span style="color:#f1fa8c">      &#34;--value&#34;,
</span><span style="color:#f1fa8c">      &#34;123&#34;
</span><span style="color:#f1fa8c">    ]
</span><span style="color:#f1fa8c">  }]&#39;</span>

<span style="color:#ff79c6">{</span>
    <span style="color:#f1fa8c">&#34;ClusterId&#34;</span>: <span style="color:#f1fa8c">&#34;j-DND71AFKD661&#34;</span>,
    <span style="color:#f1fa8c">&#34;ClusterArn&#34;</span>: <span style="color:#f1fa8c">&#34;arn:aws:elasticmapreduce:ap-northeast-1:******:cluster/j-DND71AFKD661&#34;</span>
<span style="color:#ff79c6">}</span>
</code></pre></div><p>Step starts to run when the instance is launched.</p>




<div class="img_container"><a href="/en/article/409/images/instances.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/en/article/409/images/instances_hu7b007391fe461d5eac21adcb472759f7_200277_600x370_fit_lanczos_2.png" width="600" height="184" alt="Instances">
</a></div>


<p>Running status can be checked on the management console or &ldquo;aws emr list-steps&rdquo;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-json" data-lang="json">$ aws emr list-steps --cluster-id j-DND<span style="color:#bd93f9">71</span>AFKD<span style="color:#bd93f9">661</span> | jq <span style="color:#f1fa8c">&#34;.Steps[0]&#34;</span>
{
  <span style="color:#ff79c6">&#34;Id&#34;</span>: <span style="color:#f1fa8c">&#34;s-2WT4PRXV2S3B0&#34;</span>,
  <span style="color:#ff79c6">&#34;Name&#34;</span>: <span style="color:#f1fa8c">&#34;spark-submit&#34;</span>,
  <span style="color:#ff79c6">&#34;Config&#34;</span>: {
    <span style="color:#ff79c6">&#34;Jar&#34;</span>: <span style="color:#f1fa8c">&#34;command-runner.jar&#34;</span>,
    <span style="color:#ff79c6">&#34;Properties&#34;</span>: {},
    <span style="color:#ff79c6">&#34;Args&#34;</span>: [
      <span style="color:#f1fa8c">&#34;spark-submit&#34;</span>,
      <span style="color:#f1fa8c">&#34;--master&#34;</span>,
      <span style="color:#f1fa8c">&#34;yarn&#34;</span>,
      <span style="color:#f1fa8c">&#34;--deploy-mode&#34;</span>,
      <span style="color:#f1fa8c">&#34;client&#34;</span>,
      <span style="color:#f1fa8c">&#34;s3://&lt;bucket&gt;/test.py&#34;</span>,
      <span style="color:#f1fa8c">&#34;--value&#34;</span>,
      <span style="color:#f1fa8c">&#34;123&#34;</span>
    ]
  },
  <span style="color:#ff79c6">&#34;ActionOnFailure&#34;</span>: <span style="color:#f1fa8c">&#34;TERMINATE_CLUSTER&#34;</span>,
  <span style="color:#ff79c6">&#34;Status&#34;</span>: {
    <span style="color:#ff79c6">&#34;State&#34;</span>: <span style="color:#f1fa8c">&#34;PENDING&#34;</span>,
    <span style="color:#ff79c6">&#34;StateChangeReason&#34;</span>: {},
    <span style="color:#ff79c6">&#34;Timeline&#34;</span>: {
      <span style="color:#ff79c6">&#34;CreationDateTime&#34;</span>: <span style="color:#f1fa8c">&#34;2022-06-21T23:42:52.594000+09:00&#34;</span>
    }
  }
}
</code></pre></div>



<div class="img_container"><a href="/en/article/409/images/steps.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/en/article/409/images/steps_huc71f3881f3d2f8a3ba8afc721c79b246_170128_600x370_fit_lanczos_2.png" width="600" height="260" alt="Running status">
</a></div>


<h2 id="references">References</h2>
<p><a href="https://pages.awscloud.com/rs/112-TZM-766/images/AWS_ETL_services_tips_202107.pdf">AWS で実践！Analytics Modernization ～ETL 編～ AWS ETL サービス適材適所選択のコツ</a></p>

    </div>
    <div class="share">
      <div class="cell">
        <div>share</div>
        <div>
          <a class="share-button" href='https://twitter.com/intent/tweet?url=https://www.sambaiz.net/en/article/409/&text=Run%20a%20Spark%20application%20with%20Amzon%20EMR%20-%20sambaiz-net'>
            <img src="/image/twitter.png" width="40px" height="40px" alt="twitter">
          </a>
          <a href="https://b.hatena.ne.jp/entry/" class="share-button hatena-bookmark-button" data-hatena-bookmark-layout="touch" data-hatena-bookmark-width="40" data-hatena-bookmark-height="40" title="このエントリーをはてなブックマークに追加">
            <img src="https://b.st-hatena.com/images/v4/public/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="40" height="40" style="border: none;" />
          </a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
        </div>
      </div>
    </div>
  </article>
</div>

</div>
</body>

</html>