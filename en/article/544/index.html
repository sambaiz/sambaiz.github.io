<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NCML2RV');</script>
  

  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
  <link rel="stylesheet" href="/css/destyle.css">
  <style>
    body {
        background-color: #f1f1f1;
        line-height: 1.3;
        
        font-family: "Helvetica Neue", 
            Arial, 
            "Hiragino Kaku Gothic ProN",
            "Hiragino Sans",
            "BIZ UDPGothic",
            Meiryo,
            sans-serif;
    }

    table {
        margin-block-start: 1.5rem;
        margin-block-end: 1.5rem;
    }

    table th,table td{
        padding: 0.2rem 1.0rem;
    }

    table tr{
        border-bottom: solid 1px #eee;
    }

    .languages {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 1.2rem;
        color: #3a9240;
    }

    header {
        margin-block-start: 1.875rem;
        margin-block-end: 1.875rem;
    }

    header>.title {
        font-size: 1.875rem;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .sns {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .sns-item {
        display: inline-block;
        margin: 3px;
    }

    .filmarks {
        display: inline-block;
        width: 32px;
        height: 32px;
        margin-top: 3px;
        background: url(/image/filmarks.svg) no-repeat;
        background-size: 450%;
    }

    header>.tags {
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.2rem;
        max-width: 1000px;
        margin: auto;
        padding: 0 20px;
    }

    header>.tags .others {
        font-weight: bold;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .nl {
        display: inline-block;
    }

    .cell {
        background-color: #fff;
        border-radius: 5px;
        padding: 10px;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.1) inset;
    }

    time {
        color: #333;
    }

    .tag {
        color: #3a9240;
        margin: 0 5px;
    }

    .tag:hover {
        text-decoration: underline;
    }

     
    .paging {
        display: inline-block;
        font-size: 1.25rem;
        margin: 10px 10px;
    }

    .paging.next {
        float: right;
    }


     
    .list>.title {
        font-size: 1.75rem;
        margin: 0 0 10px 10px;
    }

     
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(262px, 1fr));
        gap: 20px;
        margin: 0 10px;
    }

    .grid-nl {
        width: 100%;
    }

    .grid-cell {
        height: 11.25rem;
        overflow: hidden;
        box-sizing: content-box;
    }

    .grid-cell>.title {
        font-size: 1.4rem;
        word-wrap: break-word;
    }

     
    .single {
        margin: 0 10px 10px 10px;
        line-height: 1.5;
    }

    @media screen and (min-width: 768px) {
        .single .cell {
            padding: 10px 20px;
        }
    }

    .single-header {
        margin-block-start: 1.875rem;
        margin-block-end: 1.875rem;
        line-height: 1.3;
    }

    .single-header h1 {
        font-size: 2rem;
        font-weight: bold;
    }

    .single h2 {
        font-size: 1.8rem;
        border-bottom: 1px solid #ddd;
        margin-block-start: 1.875rem;
    }

    .single h3 {
        font-size: 1.5rem;
        margin-block-start: 1.5rem;
    }

    .single h4 {
        font-size: 1.2rem;
        margin-block-start: 1rem;
    }

    .single a {
        color: #3a9240;
    }

    .single a:hover {
        text-decoration: underline;
    }

    .single p {
        margin-block-start: 0.83rem;
        margin-block-end: 0.83rem;
    }

    code {
        
        font-family: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;
    }

    .single p>code, .single li>code {
        padding: 0 0.2rem;
        display: inline-block;
        overflow: auto;
        max-width: 100%;
        vertical-align: bottom;
    }

    .single strong {
        color: #d2691e;
        font-weight: normal;
    }

    .single .highlight {
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.3), 0 0 1px rgba(0, 0, 0, 0.1) inset;
        margin-block-start: 1rem;
        margin-block-end: 1rem;
        font-size: 0.875rem;
    }

    .single .img_container {
        margin-block-start: 0.1rem;
        margin-block-end: 0.1rem;
        text-align: center;
    }

    .single img {
        border: 1px solid #ddd;
    }

    .single .highlight>pre {
        padding: 10px;
        overflow-x: auto;
    }

    .single img {
        max-width: 100%;
    }

    .single blockquote {
        border-left: 5px solid #ddd;
        color: #777;
        padding: 1rem 0 1rem 1rem;
        margin-block-start: 0.83rem;
        margin-block-end: 0.83rem;
    }

    .single blockquote > p {
        margin-block-start: 0;
        margin-block-end: 0;
    }

    .single hr {
        color: #bbb;
        margin-block-start: 1.5rem;
        margin-block-end: 1.5rem;
    }

    .single ul {
        list-style-type: disc;
        padding-left: 1.5em;
        margin-block-end: 0.4rem;
    }
</style>
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://www.sambaiz.net/index.xml">
  <link rel="icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">

  <meta name="theme-color" content="#41a248">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@sambaiz">
  
  <title>Authenticating with Google Accounts using Microsoft Entra ID - sambaiz-net</title>
  <meta name="twitter:title" content="Authenticating with Google Accounts using Microsoft Entra ID - sambaiz-net">
  <meta property='og:title' content="Authenticating with Google Accounts using Microsoft Entra ID - sambaiz-net">
  <meta property="og:type" content="article">
  
  <meta name="description" content="Microsoft Entra ID (formerly Azure Active Directory) is an authentication and authorization platform that, like Amazon Cognito, supports both built-in user management and third-party SAML/OIDC providers">
  <meta name="twitter:description" content="Microsoft Entra ID (formerly Azure Active Directory) is an authentication and authorization platform that, like Amazon Cognito, supports both built-in user management and third-party SAML/OIDC providers">
  
  

  <meta property="og:url" content="https://www.sambaiz.net/en/article/544/">
  <meta property="og:image" content="https://www.sambaiz.net/images/my_l.jpg">
  <meta name="twitter:image" content="https://www.sambaiz.net/images/my.jpg" />

  
  
  <link rel="alternate" hreflang="ja" href="https://www.sambaiz.net/article/544/" />
  
  <link rel="alternate" hreflang="x-default" href="https://www.sambaiz.net/article/544/" />
  
  
  <link rel="alternate" hreflang="en" href="https://www.sambaiz.net/en/article/544/" />
  
  
  

  
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id": "https://www.sambaiz.net/"
    },
    "headline": "Authenticating with Google Accounts using Microsoft Entra ID",
    "datePublished": "2025-11-01T23:47:00JST",
    "dateModified": "2025-11-01T23:47:00JST",
    "author": {
      "@type": "Person",
      "name": "sambaiz",
      "url": "https://www.sambaiz.net/",
      "image": "https://www.sambaiz.net/images/my.jpg"
    },
    "publisher": {
      "@type": "Person",
      "name": "sambaiz-net",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.sambaiz.net/images/my.jpg",
        "height": 60,
        "width": 60
      }
    },
    "image": {
      "@type": "ImageObject",
      "url": "https://www.sambaiz.net/images/my.jpg",
      "height": 138,
      "width": 138
    },
    "description": "Microsoft Entra ID (formerly Azure Active Directory) is an authentication and authorization platform that, like Amazon Cognito, supports both built-in user management and third-party SAML/OIDC providers"
  }
</script>
</head>

<body>
  
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCML2RV"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <div>
    <div class="languages">
      
      <ul>
          
          <li>
              <a href="https://www.sambaiz.net/article/544/">日本語</a>
          </li>
          
      </ul>
      
    </div>

    <header>
      <div class="title">
        <img src="https://www.sambaiz.net/images/my.png" width="60px" height="60px" alt="icon" />
        <a class="nl" href='/en/'>
          <h1>sambaiz-net</h1>
        </a>
      </div>

      <div class="sns">
        <div class="sns-item">
          <a class="nl" href="https://github.com/sambaiz">
            <img src="/image/github.png" width="30px" height="30px" alt="github">
          </a>
        </div>
        <div class="sns-item">
          <a class="nl" href="https://www.google.com/maps/contrib/102687103399829824749/photos">
            <img src="/image/googlemaps.svg" width="30px" height="30px" alt="google maps">
          </a>
        </div>
        <div class="sns-item">
          <a class="nl" href="https://boardgamearena.com/player?id=83835726">
            <img src="/image/boardgamearena.webp" width="30px" height="30px" alt="board game arena">
          </a>
        </div>
      </div>
      <div class="tags">
        <div>
          
          <a class="tag" href="/tags/aws/">
            aws</a>
          
          <a class="tag" href="/tags/golang/">
            golang</a>
          
          <a class="tag" href="/tags/machinelearning/">
            machinelearning</a>
          
          <a class="tag" href="/tags/kubernetes/">
            kubernetes</a>
          
          <a class="tag" href="/tags/python/">
            python</a>
          
          <a class="tag" href="/tags/etl/">
            etl</a>
          
          <a class="tag" href="/tags/gcp/">
            gcp</a>
          
          <a class="tag" href="/tags/spark/">
            spark</a>
          
          <a class="tag" href="/tags/web/">
            web</a>
          
          <a class="tag" href="/tags/fluentd/">
            fluentd</a>
          
          <a class="tag others" href="/tags/">...</a>
        </div>
      </div>
    </header>

<div class="container">
  <article class="single">
    <div class="cell">
      <div class="single-header">
        <h1>Authenticating with Google Accounts using Microsoft Entra ID</h1>
        <time>2025-11-01</time>
        <a class="tag" href='/en/tags/azure/'>azure</a><a class="tag" href='/en/tags/auth/'>auth</a>
      </div>
      <p><a href="https://www.microsoft.com/ja-jp/security/business/identity-access/microsoft-entra-id">Microsoft Entra ID</a> (formerly Azure Active Directory) is an authentication and authorization platform that, like Amazon Cognito, supports both built-in user management and third-party SAML/OIDC providers.
While <a href="https://www.microsoft.com/ja-jp/security/business/microsoft-entra-pricing">pricing</a> is charged per user, Azure&rsquo;s EntraID Free can be used at no cost.</p>
<p>Create an <a href="https://console.cloud.google.com/auth/overview">OAuth client in Google Cloud</a> and obtain the Client ID and Secret.</p>




<div class="img_container"><a href="/article/544/images/authorized_domains.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/authorized_domains_hu_23641ea3ef166e5c.png" width="573" height="370" alt="Authorized domains configuration">
</a></div>


<p>The <a href="https://learn.microsoft.com/en-us/entra/external-id/customers/how-to-google-federation-customers">Authorized URIs</a> to register with the client include the tenant (directory) ID and domain name xxx.onmicrosoft.com.</p>




<div class="img_container"><a href="/article/544/images/google_oauth_client.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/google_oauth_client_hu_1f033ebcf65f042f.png" width="301" height="370" alt="Creating OAuth client">
</a></div>


<p>Enter the obtained Client ID and Secret in the Google settings under External Identities&rsquo; built-in identity providers.</p>




<div class="img_container"><a href="/article/544/images/external_identities.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/external_identities_hu_248971813a3d74a4.png" width="600" height="253" alt="Google settings for built-in identity providers">
</a></div>


<p>Invite an external user with a Google account to the tenant.</p>




<div class="img_container"><a href="/article/544/images/invite_external_user.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/invite_external_user_hu_e0acefcf946d5e4b.png" width="600" height="332" alt="Inviting external user">
</a></div>


<p>A user with ID Google.com will be added.</p>




<div class="img_container"><a href="/article/544/images/google_user.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/google_user_hu_a0003e02877eff2a.png" width="600" height="208" alt="Google.com user">
</a></div>


<p>Next, register an app in the tenant and obtain the Application (client) ID.</p>




<div class="img_container"><a href="/article/544/images/azure_app.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/azure_app_hu_e44a4345ffb9b464.png" width="451" height="370" alt="App registration">
</a></div>


<p>Use <a href="https://github.com/AzureAD/microsoft-authentication-library-for-js">MSAL.js (Microsoft Authentication Library for JavaScript)</a> to perform the <a href="https://learn.microsoft.com/ja-jp/entra/identity-platform/v2-oauth2-auth-code-flow">OAuth 2.0 Authorization Code Flow with PKCE</a>.</p>
<p><a href="https://www.sambaiz.net/article/48/">OAuth2.0のメモ - sambaiz-net</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>$ cat index.html
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#ff79c6">meta</span> <span style="color:#50fa7b">charset</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#ff79c6">script</span> <span style="color:#50fa7b">src</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;https://alcdn.msauth.net/browser/2.14.2/js/msal-browser.min.js&#34;</span>&gt;&lt;/<span style="color:#ff79c6">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#ff79c6">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#ff79c6">h1</span>&gt;Entra ID Auth Test&lt;/<span style="color:#ff79c6">h1</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;error&#34;</span> <span style="color:#50fa7b">style</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;display:none; background:#fee; border:1px solid #fcc; padding:10px; margin:10px 0;&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#ff79c6">strong</span>&gt;Error:&lt;/<span style="color:#ff79c6">strong</span>&gt; &lt;<span style="color:#ff79c6">span</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;error-msg&#34;</span>&gt;&lt;/<span style="color:#ff79c6">span</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#ff79c6">button</span> <span style="color:#50fa7b">onclick</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login()&#34;</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;login-btn&#34;</span>&gt;Sign In&lt;/<span style="color:#ff79c6">button</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#ff79c6">div</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;user&#34;</span> <span style="color:#50fa7b">style</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;display:none;&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#ff79c6">details</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#ff79c6">summary</span>&gt;Token&lt;/<span style="color:#ff79c6">summary</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#ff79c6">pre</span> <span style="color:#50fa7b">id</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;token&#34;</span>&gt;&lt;/<span style="color:#ff79c6">pre</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#ff79c6">details</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#ff79c6">button</span> <span style="color:#50fa7b">onclick</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;logout()&#34;</span>&gt;Sign Out&lt;/<span style="color:#ff79c6">button</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#ff79c6">div</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#ff79c6">script</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">const</span> CLIENT_ID <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&lt;CLIENT_ID&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">const</span> TENANT_ID <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;&lt;TENANT_ID&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">const</span> msal <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> <span style="color:#8be9fd;font-style:italic">window</span>.msal.PublicClientApplication({
</span></span><span style="display:flex;"><span>            auth<span style="color:#ff79c6">:</span> {
</span></span><span style="display:flex;"><span>                clientId<span style="color:#ff79c6">:</span> CLIENT_ID,
</span></span><span style="display:flex;"><span>                authority<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">`https://login.microsoftonline.com/</span><span style="color:#f1fa8c">${</span>TENANT_ID<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>,
</span></span><span style="display:flex;"><span>                redirectUri<span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;http://localhost:3000&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        msal.initialize().then(() =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">const</span> accounts <span style="color:#ff79c6">=</span> msal.getAllAccounts();
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> (accounts.length <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0</span>) show(accounts[<span style="color:#bd93f9">0</span>]);
</span></span><span style="display:flex;"><span>        }).<span style="color:#ff79c6">catch</span>(err =&gt; {
</span></span><span style="display:flex;"><span>            showError(<span style="color:#f1fa8c">`Initialization error: </span><span style="color:#f1fa8c">${</span>err.message<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">async</span> <span style="color:#8be9fd;font-style:italic">function</span> login() {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">const</span> btn <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;login-btn&#39;</span>);
</span></span><span style="display:flex;"><span>            btn.disabled <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">true</span>;
</span></span><span style="display:flex;"><span>            btn.textContent <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;Signing in...&#39;</span>;
</span></span><span style="display:flex;"><span>            hideError();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">const</span> res <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">await</span> msal.loginPopup({ scopes<span style="color:#ff79c6">:</span> [<span style="color:#f1fa8c">&#34;User.Read&#34;</span>] });
</span></span><span style="display:flex;"><span>                show(res.account);
</span></span><span style="display:flex;"><span>            } <span style="color:#ff79c6">catch</span> (err) {
</span></span><span style="display:flex;"><span>                console.error(err);
</span></span><span style="display:flex;"><span>                showError(<span style="color:#f1fa8c">`Login failed: </span><span style="color:#f1fa8c">${</span>err.message <span style="color:#ff79c6">||</span> err.errorMessage <span style="color:#ff79c6">||</span> err<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>);
</span></span><span style="display:flex;"><span>                btn.disabled <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">false</span>;
</span></span><span style="display:flex;"><span>                btn.textContent <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;Sign In&#39;</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">async</span> <span style="color:#8be9fd;font-style:italic">function</span> logout() {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#ff79c6">await</span> msal.logoutPopup();
</span></span><span style="display:flex;"><span>                <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;login&#39;</span>).style.display <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;block&#39;</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;user&#39;</span>).style.display <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;none&#39;</span>;
</span></span><span style="display:flex;"><span>                hideError();
</span></span><span style="display:flex;"><span>            } <span style="color:#ff79c6">catch</span> (err) {
</span></span><span style="display:flex;"><span>                showError(<span style="color:#f1fa8c">`Logout failed: </span><span style="color:#f1fa8c">${</span>err.message<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">`</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">function</span> show(acc) {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;login&#39;</span>).style.display <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;none&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;user&#39;</span>).style.display <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;block&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;token&#39;</span>).textContent <span style="color:#ff79c6">=</span> JSON.stringify(acc.idTokenClaims, <span style="color:#ff79c6">null</span>, <span style="color:#bd93f9">2</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">function</span> showError(msg) {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;error&#39;</span>).style.display <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;block&#39;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;error-msg&#39;</span>).textContent <span style="color:#ff79c6">=</span> msg;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd;font-style:italic">function</span> hideError() {
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">document</span>.getElementById(<span style="color:#f1fa8c">&#39;error&#39;</span>).style.display <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;none&#39;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#ff79c6">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#ff79c6">html</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ python3 -m http.server 3000
</span></span></code></pre></div><p>During login, when you enter a Google account user&rsquo;s email address, you will be redirected to the Google login screen.</p>




<div class="img_container"><a href="/article/544/images/login_with_google.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/login_with_google_hu_2b5f1ff5eec0e82.png" width="548" height="370" alt="Redirect to Google login screen">
</a></div>


<p>Once authentication is complete, the contents of the OIDC ID token <a href="https://learn.microsoft.com/en-us/entra/identity-platform/id-token-claims-reference">containing</a> Entra ID-specific fields will be displayed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;aud&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;********&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;iss&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;https://login.microsoftonline.com/********/v2.0&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;iat&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#bd93f9">1761996502</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;nbf&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#bd93f9">1761996502</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;exp&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#bd93f9">1762000402</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;idp&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;google.com&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;name&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;Taiki Sakamoto (Google Account)&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;nonce&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;********-****-****-****-************&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;oid&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;********-****-****-****-************&#34;</span>,  <span style="color:#6272a4">// User&#39;s Object ID
</span></span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;preferred_username&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;********@gmail.com&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;rh&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;********&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;sid&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;********-****-****-****-************&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;sub&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;********&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;tid&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;********-****-****-****-************&#34;</span>,  <span style="color:#6272a4">// Tenant ID
</span></span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;uti&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;********&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;ver&#34;</span><span style="color:#ff79c6">:</span> <span style="color:#f1fa8c">&#34;2.0&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When you add optional claims to the application&rsquo;s token configuration, the corresponding fields will be added.</p>




<div class="img_container"><a href="/article/544/images/token_group_id.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/token_group_id_hu_97928b9ff4dd2b80.png" width="600" height="362" alt="Adding group claims">
</a></div>


<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;groups&#34;</span><span style="color:#ff79c6">:</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;********-****-****-****-************&#34;</span>
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>By default, all users in the tenant can authenticate, but by enabling assignment requirement in the settings, you can restrict access to only users or groups that have been assigned to the application in advance. However, with the Free tier, it was not possible to assign groups.</p>




<div class="img_container"><a href="/article/544/images/assign_required.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/assign_required_hu_105d81e02604ee42.png" width="600" height="228" alt="Making user/group assignment required">
</a></div>


<p>Besides, by defining app roles and assigning them to users or groups, they will be included in the token, allowing the application to handle them.</p>




<div class="img_container"><a href="/article/544/images/app_role.png">
    <img style="max-width: 100%; width: auto; height: auto;" src="/article/544/images/app_role_hu_c72d17d82a84047b.png" width="600" height="279" alt="Creating app role">
</a></div>


<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#f1fa8c">&#34;roles&#34;</span><span style="color:#ff79c6">:</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#34;admin&#34;</span>
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
    </div>
  </article>
</div>

</div>
</body>

</html>