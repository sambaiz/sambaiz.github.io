<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>sambaiz-net</title>
    <link>http://sambaiz.net/tags/node.js/index.xml</link>
    <language>ja</language>
    <author>sambaiz</author>
    <rights>(C) 2017</rights>
    <updated>0001-01-01 00:00:00 &#43;0000 UTC</updated>

    
      
        <item>
          <title>Node.jsã®Stream API</title>
          <link>http://sambaiz.net/article/96/</link>
          <pubDate>Sat, 22 Apr 2017 19:06:00 &#43;0900</pubDate>
          <author></author>
          <guid>http://sambaiz.net/article/96/</guid>
          <description>

&lt;h2 id=&#34;stream-apiã¨ã¯-https-nodejs-org-docs-v7-9-0-api-stream-html&#34;&gt;&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html&#34;&gt;Stream APIã¨ã¯&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Nodeã§Streamãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†ãŸã‚ã®ã‚‚ã®ã€‚
ä¾‹ãˆã°ã‚µã‚¤ã‚ºãŒå¤§ãã„ãƒ•ã‚¡ã‚¤ãƒ«ã®å…¥å‡ºåŠ›ã‚’Streamã¨ã—ã¦æ‰±ã†ã“ã¨ã§ãƒãƒƒãƒ•ã‚¡ã‚’æœ€å°é™ã«ã§ãã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;Streamã¯&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/events.html&#34;&gt;EventEmitter&lt;/a&gt;ã§ã€
Readable streamã‚„Writable streamã€Readableã¨Writableã‚’åˆã‚ã›ãŸDuplex streamã¨
Readã—ãŸã‚‚ã®ã‚’åŠ å·¥ã—ã¦Writeã™ã‚‹Transform streamã®ç¨®é¡ãŒã‚ã‚Šã€
ãã‚Œãã‚Œç‰¹å®šã®é–¢æ•°ãŒ&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html#stream_api_for_stream_implementers&#34;&gt;å®Ÿè£…&lt;/a&gt;ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚&lt;/p&gt;

&lt;h2 id=&#34;readable-stream-https-nodejs-org-docs-v7-9-0-api-stream-html-stream-readable-streams&#34;&gt;&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html#stream_readable_streams&#34;&gt;Readable stream&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Readable streamã«ã¯&lt;code&gt;flowing&lt;/code&gt;ã¨&lt;code&gt;paused&lt;/code&gt;ã®
&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html#stream_two_modes&#34;&gt;äºŒã¤ã®ãƒ¢ãƒ¼ãƒ‰&lt;/a&gt;ãŒã‚ã‚‹ã€‚
æœ€åˆã¯&lt;code&gt;paused&lt;/code&gt;ãƒ¢ãƒ¼ãƒ‰ã§ã€readableã«ãªã£ã¦ã‹ã‚‰read()ã™ã‚‹ã“ã¨ã§èª­ã‚€ã“ã¨ãŒã§ãã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const fs = require(&#39;fs&#39;);
let readable = fs.createReadStream(&#39;sample.txt&#39;);
var i = 0;
readable.on(&#39;readable&#39;, () =&amp;gt; {
  let chunk;
  while (null !== (chunk = readable.read(10))) {
    console.log(`${i++}: ${chunk}`);
  }
});
dable.on(&#39;end&#39;, () =&amp;gt; {
  console.log(&#39;end&#39;);
});
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;$ cat sample.txt
abcdefghijklmnopqrstuvwxyz
1234567890
ã‚ã„ã†ãˆãŠ

$ node main.js
0: abcdefghij
1: klmnopqrst
2: uvwxyz
123
3: 4567890
ã‚ã„
4: ã†ãˆãŠ

end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;dataã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã‹ã€å¾Œã§æ›¸ãpipeã‚’ä½¿ã†ã¨&lt;code&gt;flowing&lt;/code&gt;ãƒ¢ãƒ¼ãƒ‰ã«ãªã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const fs = require(&#39;fs&#39;);
let readable = fs.createReadStream(&#39;sample.txt&#39;);
var i = 0;
readable.on(&#39;data&#39;, (chunk) =&amp;gt; {
  console.log(`${i++}: ${chunk}`);
});
readable.on(&#39;end&#39;, () =&amp;gt; {
  console.log(&#39;end&#39;);
});
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;0: abcdefghijklmnopqrstuvwxyz
1234567890
ã‚ã„ã†ãˆãŠ

end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯ã“ã‚“ãªæ„Ÿã˜ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const fs = require(&#39;fs&#39;);
let readable = fs.createReadStream(&#39;error.txt&#39;);
readable.on(&#39;data&#39;, (chunk) =&amp;gt; {
  console.log(`${i++}: ${chunk}`);
});
readable.on(&#39;error&#39;, (error) =&amp;gt; {
  console.log(error);
});
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;$ node main.js
{ Error: ENOENT: no such file or directory, open &#39;error.txt&#39;
    at Error (native) errno: -2, code: &#39;ENOENT&#39;, syscall: &#39;open&#39;, path: &#39;error.txt&#39; }
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;å®Ÿè£…-https-nodejs-org-docs-v7-9-0-api-stream-html-stream-implementing-a-readable-stream&#34;&gt;&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html#stream_implementing_a_readable_stream&#34;&gt;å®Ÿè£…&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;å®Ÿè£…ã™ã‚‹é–¢æ•°ã¯&lt;code&gt;_read&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const Readable = require(&#39;stream&#39;).Readable;

class Random extends Readable {
  constructor(opt) {
    super(opt); 
  }
  
  _read() {
    
    // error handling
    // if(err){ 
    //   this.emit(&#39;error&#39;, err)
    //   return
    // }
    
    this.push(Math.random()+&#39;&#39;);
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;writable-stream-https-nodejs-org-docs-v7-9-0-api-stream-html-stream-class-stream-writable&#34;&gt;&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html#stream_class_stream_writable&#34;&gt;Writable stream&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;output.txtã«å‡ºåŠ›ã™ã‚‹Writable streamã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let writable = fs.createWriteStream(&#39;output.txt&#39;)

writable.write(&#39;hoge\n&#39;);
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;$ cat output.txt
hoge
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¥åŠ›ã®æµé‡ãŒå¤šãã€Writable streamã®ãƒãƒƒãƒ•ã‚¡ãŒ&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html#stream_constructor_new_stream_writable_options&#34;&gt;highWaterMark&lt;/a&gt;ã‚’è¶…ãˆã¦ã—ã¾ã†ã¨ã€write()ã¯falseã‚’è¿”ã™ã€‚ãã®ã¾ã¾æ›¸ãè¾¼ã¿ç¶šã‘ã‚‹ã¨ãƒ¡ãƒ¢ãƒªã‚’é£Ÿã„ã¤ã¶ã—ã¦ã—ã¾ã†ã®ã§ã€
å…¨ã¦ã®ãƒãƒƒãƒ•ã‚¡ãŒæŒã‘ã¦&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html#stream_event_drain&#34;&gt;drain&lt;/a&gt;ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºè¡Œã•ã‚Œã‚‹ã¾ã§æ›¸ãè¾¼ã¿ã‚’æ­¢ã‚ã¦back-pressureã¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
ãŸã ã—ã€pipeã‚’ä½¿ã†å ´åˆã“ã®ã‚ãŸã‚Šã¯ã‚„ã£ã¦ãã‚Œã‚‹ã®ã§ã€ã‚ã¾ã‚Šæ°—ã«ã™ã‚‹ã“ã¨ã¯ãªã„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å®Ÿè£…-https-nodejs-org-docs-v7-9-0-api-stream-html-stream-implementing-a-writable-stream&#34;&gt;&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html#stream_implementing_a_writable_stream&#34;&gt;å®Ÿè£…&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;å®Ÿè£…ã™ã‚‹é–¢æ•°ã¯&lt;code&gt;_write&lt;/code&gt;ã¨ã€ãƒãƒƒãƒ•ã‚¡ã•ã‚Œã¦ã„ã‚‹chunkã‚’ã¾ã¨ã‚ã¦æ‰±ã†ãªã‚‰&lt;code&gt;_writev&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const Writable = require(&#39;stream&#39;).Writable;

class DummyWritable extends Writable {
  constructor(opt) {
    super(opt);
  }

  _write(chunk, encoding, callback) {
    const chunkStr = chunk.toString()
    if (chunkStr == &#39;this is error&#39;) {
      callback(new Error(&#39;chunk is invalid&#39;));
    } else {
      console.log(chunkStr);
      callback();
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;pipe-https-nodejs-org-docs-v7-9-0-api-stream-html-stream-readable-pipe-destination-options&#34;&gt;&lt;a href=&#34;https://nodejs.org/docs/v7.9.0/api/stream.html#stream_readable_pipe_destination_options&#34;&gt;pipe&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Readable streamã‚’Writable streamã¨ã¤ãªã’ã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const fs = require(&#39;fs&#39;);
let readable = fs.createReadStream(&#39;sample.txt&#39;);
let writable = fs.createWriteStream(&#39;output.txt&#39;);
readable.pipe(writable);
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;$ cat output.txt
abcdefghijklmnopqrstuvwxyz
1234567890
ã‚ã„ã†ãˆãŠ
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ã™ã¹ããªã®ã¯ã€pipeã—ãŸã‚‚ã®ã‚’ã¾ã¨ã‚ã¦ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã¯ã§ããªã„ã“ã¨ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const fs = require(&#39;fs&#39;);
let readable = fs.createReadStream(&#39;error.txt&#39;);
let writable = fs.createWriteStream(&#39;output.txt&#39;);
let piped = readable.pipe(writable);

piped.on(&#39;error&#39;, (error) =&amp;gt; {
  console.log(error);
});
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;events.js:160
      throw er; // Unhandled &#39;error&#39; event
      ^

Error: ENOENT: no such file or directory, open &#39;error.txt&#39;
    at Error (native)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é¢å€’ã ã‘ã©ã€æ¯åº¦ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const fs = require(&#39;fs&#39;);
let readable = fs.createReadStream(&#39;error.txt&#39;);
let writable = fs.createWriteStream(&#39;output.txt&#39;);
const errorHandling = (err) =&amp;gt; { console.log(err) }
let piped = readable.on(&#39;error&#39;, errorHandling).pipe(writable);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;pipeã‚’çµ„ã¿åˆã‚ã›ã‚‹ã¨ã€ã“ã‚“ãªé¢¨ã«csvã‚’fetchã—ã¦åŠ å·¥ã—ã€æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰ãˆã¦å‡ºåŠ›ã™ã‚‹ã¨ã„ã£ãŸã“ã¨ã‚‚Streamã§ã§ãã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const fetch = require(&#39;node-fetch&#39;);
const Iconv = require(&#39;iconv&#39;).Iconv;
const iconv = new Iconv(&#39;UTF-8&#39;, &#39;SHIFT_JIS//IGNORE&#39;);
const csv = require(&#39;csv&#39;);
const fs = require(&#39;fs&#39;);

const errorHandling = (err) =&amp;gt; { console.log(err); };

const outputFile = fs.createWriteStream(&#39;output.csv&#39;);

fetch(&#39;http://example.com/test.csv&#39;).then((res) =&amp;gt; {

  res.body
  .pipe(csv.parse({columns : true}))
  .on(&#39;error&#39;, errorHandling)
  .pipe(csv.transform(function(record){
    if(record[&#39;hoge&#39;] &amp;lt; 100000){
      return null;
    }
    return record;
  }))
  .on(&#39;error&#39;, errorHandling)
  .pipe(csv.stringify({header: true}))
  .on(&#39;error&#39;, errorHandling)
  .pipe(iconv)
  .on(&#39;error&#39;, errorHandling)
  .pipe(outputFile)
  .on(&#39;error&#39;, errorHandling);

}).then(() =&amp;gt; console.log(&amp;quot;done&amp;quot;)).catch((err) =&amp;gt; console.log(err));
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;pipeã§ã¯ãªã„ã‘ã©ã€readlineã®createInterfaceã«å…¥åŠ›ã¨å‡ºåŠ›ã®Streamã‚’æ¸¡ã™ã¨ã€
è¡Œã”ã¨ã«å‡¦ç†ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const fs = require(&#39;fs&#39;);
const readline = require(&#39;readline&#39;);

let readable = fs.createReadStream(&#39;sample.txt&#39;);
const rl = readline.createInterface({
  input: readable,
  output: process.stdout
});
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;abcdefghijklmnopqrstuvwxyz
1234567890
ã‚ã„ã†ãˆãŠ
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;rxjsã§æ‰±ã†&#34;&gt;RxJSã§æ‰±ã†&lt;/h2&gt;

&lt;p&gt;Streamã¯EventEmitterãªã®ã§RxJSã®fromEvent()ã§Observableã¨ã—ã¦æ‰±ã†ã“ã¨ã‚‚ã§ãã‚‹ã€‚ãŸã ã—&lt;a href=&#34;https://github.com/ReactiveX/rxjs&#34;&gt;v5&lt;/a&gt;ã«ã¯pipeãŒãªã„(v4ã«ã¯&lt;a href=&#34;https://github.com/Reactive-Extensions/RxJS/blob/8fa95ac884181fb6cbff8ce7c1d669ffb190f5e4/src/core/linq/observable/pipe.js#L6&#34;&gt;ã‚ã‚‹&lt;/a&gt;)ã®ã§ã€pipeã™ã‚‹å ´åˆã¯è‡ªåˆ†ã§Subscribeã—ã¦writeã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://sambaiz.net/article/85/&#34;&gt;RxJSã§Rxã‚’ã¯ã˜ã‚ã‚‹ - sambaiz.net&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const fs = require(&#39;fs&#39;);
const Rx = require(&#39;rxjs/Rx&#39;);
const writable = fs.createWriteStream(&#39;output.txt&#39;)

Rx.Observable.fromEvent(process.stdin, &#39;data&#39;)
.map((v) =&amp;gt; `- ${v}`)
.subscribe((v) =&amp;gt; write(v));

function write(v){
  // TODO: back-pressure
  writable.write(v);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;$ node main.js 
aiueo
kakikukeko
^C

$ cat output.txt 
- aiueo
- kakikukeko
&lt;/code&gt;&lt;/pre&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Nightmareã§ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®æ“ä½œã‚’è‡ªå‹•åŒ–ã™ã‚‹</title>
          <link>http://sambaiz.net/article/90/</link>
          <pubDate>Wed, 29 Mar 2017 23:18:00 &#43;0900</pubDate>
          <author></author>
          <guid>http://sambaiz.net/article/90/</guid>
          <description>&lt;p&gt;æœ€è¿‘ã€&lt;a href=&#34;http://postwash.net/&#34;&gt;POSTWASH&lt;/a&gt;ã¨ã„ã†æ´—æ¿¯ä»£è¡Œã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚
å°‚ç”¨ã®ã‚«ãƒãƒ³ã«è©°ã‚ã¦é›†è·ã«ããŸäººã«æ¸¡ã™ã¨ã€ãã‚Œã„ã«ç•³ã¾ã‚ŒãŸæ´—æ¿¯ã‚‚ã®ãŒå±Šãä¾¿åˆ©ãªã‚µãƒ¼ãƒ“ã‚¹ã ã€‚
æ³¨æ–‡æ™‚ã«ã¯Webã®ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰é›†è·ã€é…é”æ™‚é–“ã‚„æ”¯æ‰•ã„æ–¹æ³•ãªã©ã‚’é¸ã¶å¿…è¦ãŒã‚ã‚‹ã‚“ã ã‘ã©ã€æ¯é€±ã®ã“ã¨ãªã®ã§ã“ã‚Œã‚’è‡ªå‹•åŒ–ã—ã¦ã¿ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ãƒ–ãƒ©ã‚¦ã‚¶ã®æ“ä½œã‚’è‡ªå‹•åŒ–ã™ã‚‹ã®ã«&lt;a href=&#34;https://github.com/segmentio/nightmare&#34;&gt;Nightmare&lt;/a&gt;ã‚’ä½¿ã†ã€‚
&lt;a href=&#34;https://electron.atom.io/&#34;&gt;Electron&lt;/a&gt;ã‚’ä½¿ã£ã¦ã„ã¦ã€&lt;a href=&#34;http://phantomjs.org/&#34;&gt;PahntomJS&lt;/a&gt;ã‚ˆã‚Š2å€ãã‚‰ã„é€Ÿãã€ç°¡æ½”ã«æ›¸ã‘ã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ npm install nightmare
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;Nightmare()&lt;/code&gt;ã®å¼•æ•°ã«&lt;code&gt;show: true&lt;/code&gt;ã‚’æ¸¡ã™ã¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ã„ã¦å®Ÿè¡Œã—å§‹ã‚ã‚‹ã€‚
ã“ã‚Œã§ç¢ºèªç”»é¢ã¾ã§ã„ãã®ã§ã‚ã¨ã¯æ³¨æ–‡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã ã‘ã€‚
ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‰ã˜ãªã„ã‚ˆã†ã«æœ€å¾Œã«&lt;code&gt;nightmare.end()&lt;/code&gt;ã‚’å‘¼ã‚“ã§ã„ãªã„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const co = require(&#39;co&#39;);
const moment = require(&#39;moment&#39;)
const jst = +9
const Nightmare = require(&#39;nightmare&#39;);		
const nightmare = Nightmare({ 
  show: true,
  waitTimeout: 3000,
  gotoTimeout: 3000
});
const loginID = process.env.LOGIN_ID;
const loginPassword = process.env.LOGIN_PASSWORD;

moment.locale(&#39;ja&#39;);
const now = moment().utcOffset(jst)
const dayAfterTomorrow = now.add(2, &#39;days&#39;).format(&amp;quot;YYYYå¹´MæœˆDæ—¥(ddd)&amp;quot;);
const nextWeek = now.add(7, &#39;days&#39;).format(&amp;quot;YYYYå¹´MæœˆDæ—¥(ddd)&amp;quot;)
console.log(`${dayAfterTomorrow}~${nextWeek}`);

// IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥ã‚Œã¦ãƒ­ã‚°ã‚¤ãƒ³
const login = () =&amp;gt; nightmare
  .goto(&#39;https://sv359.xserver.jp/~postwash/postwash.net/accounts/&#39;)
  .type(&#39;#loginid&#39;, loginID)
  .insert(&#39;#loginpw&#39;, loginPassword) // .insert() is faster than .type() but does not trigger the keyboard events.
  .click(&#39;#submit&#39;)
  .wait(&#39;#yokoso&#39;)
  .evaluate(() =&amp;gt; document.querySelector(&#39;#yokoso h5&#39;).textContent);

// æ³¨æ–‡ãƒ•ã‚©ãƒ¼ãƒ ã‚’åŸ‹ã‚ã¦ã„ã
const order = () =&amp;gt; nightmare
  .goto(&#39;https://sv359.xserver.jp/~postwash/postwash.net/mypage/order.html&#39;)
  .wait(&#39;#item\\[4\\]&#39;)
  .check(&#39;#item\\[4\\]&#39;)
  .insert(&#39;#itemnum\\[4\\]&#39;, &#39;1&#39;)
  .select(&#39;#pickup_date_request&#39;, dayAfterTomorrow)
  .select(&#39;#pickup_time_request&#39;, &#39;åˆå‰ä¸­ï¼ˆ8æ™‚ï½12æ™‚ï¼‰&#39;)
  .wait(500) // #delivery_date_request ãŒåˆ‡ã‚Šæ›¿ã‚ã£ã¦ã—ã¾ã†ã®ã§å°‘ã—å¾…ã¤
  .select(&#39;#delivery_date_request&#39;, nextWeek)
  .select(&#39;#delivery_time_request&#39;, &#39;åˆå‰ä¸­ï¼ˆ8æ™‚ï½12æ™‚ï¼‰&#39;)
  .select(&#39;#payment&#39;, &#39;ä»£é‡‘å¼•æ›&#39;)
  .check(&#39;#agreement&#39;)
  .click(&#39;#submit&#39;)

co(function *(){
    yield login().then(
        (result) =&amp;gt; console.log(result), // ã‚ˆã†ã“ã
        (err) =&amp;gt; console.log(err)
    );
    yield order();
    // yield nightmare.end();
});
&lt;/code&gt;&lt;/pre&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Node.jsã§ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›</title>
          <link>http://sambaiz.net/article/89/</link>
          <pubDate>Tue, 28 Mar 2017 21:36:00 &#43;0900</pubDate>
          <author></author>
          <guid>http://sambaiz.net/article/89/</guid>
          <description>

&lt;p&gt;&lt;a href=&#34;https://github.com/bnoordhuis/node-iconv&#34;&gt;node-iconv&lt;/a&gt;ã‚’ä½¿ã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ npm install iconv
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;SHIFT_JISã‹ã‚‰UTF-8ã¸ã®å¤‰æ›ã¯ã“ã‚“ãªæ„Ÿã˜ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const Iconv  = require(&#39;iconv&#39;).Iconv;

const before = new Buffer([
    0x8b, 0x8d, 
    0x8e, 0x4d, 
    0x26,
    0x82, 0xb2,
    0x94, 0xd1
]);

const iconv = new Iconv(&#39;SHIFT_JIS&#39;, &#39;UTF-8&#39;);
console.log(`before: ${before.toString(&#39;hex&#39;)} ${before.toString()}`)
const after = iconv.convert(before);
console.log(`after:  ${after.toString(&#39;hex&#39;)} ${after.toString()}`);
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;before: 8b8d8e4d2682b294d1 ï¿½ï¿½ï¿½M&amp;amp;ï¿½ï¿½ï¿½ï¿½
after:  e7899be79abf26e38194e9a3af ç‰›çš¿&amp;amp;ã”é£¯
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ–‡å­—ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦ã¯å¤‰æ›å¾Œã«è¡¨ã›ãªã„ã“ã¨ãŒã‚ã‚‹ã€‚
ä¾‹ãˆã°ã€UTF-8ã‹ã‚‰SHIFT_JISã¸ã®å¤‰æ›ã§ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒšã‚¢ğŸšã‚’æ¸¡ã™ã¨å¤‰æ›ã§ããšã€ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;throw errnoException(&#39;EILSEQ&#39;, &#39;Illegal character sequence.&#39;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;//IGNORE&lt;/code&gt;ã‚’&lt;a href=&#34;https://www.npmjs.com/package/iconv#dealing-with-untranslatable-characters&#34;&gt;ä»˜ã‘ã‚‹&lt;/a&gt;ã“ã¨ã§
ãã®ã‚ˆã†ãªæ–‡å­—ãŒã‚ã£ãŸå ´åˆã§ã‚‚ã‚¨ãƒ©ãƒ¼ã«ã—ãªã„ã‚ˆã†ã«ã§ãã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const Iconv  = require(&#39;iconv&#39;).Iconv;

const before = &amp;quot;ç‰›çš¿&amp;amp;ğŸš&amp;quot;;

const iconv = new Iconv(&#39;UTF-8&#39;, &#39;SHIFT_JIS//IGNORE&#39;);
console.log(`before: ${new Buffer(before).toString(&#39;hex&#39;)} ${before.toString()}`)
const conv = iconv.convert(before);
const iconv2 = new Iconv(&#39;SHIFT_JIS&#39;, &#39;UTF-8&#39;);
const after = iconv2.convert(conv);
console.log(`after:  ${after.toString(&#39;hex&#39;)} ${after.toString()}`);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¤‰æ›ã§ããªã„ã‚‚ã®ã¯ç„¡è¦–ã•ã‚Œã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;before: e7899be79abf26f09f8d9a ç‰›çš¿&amp;amp;ğŸš
after:  e7899be79abf26 ç‰›çš¿&amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;lambdaã§ã¯&#34;&gt;Lambdaã§ã¯&lt;/h2&gt;

&lt;p&gt;Lambdaã§ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹iconvã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã“ã¨ãŒã§ãã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;return new Promise((resolve, reject) =&amp;gt; {
    let filePath = &amp;quot;/tmp/shiftjis&amp;quot;;
    fs.writeFileSync(filePath, shiftjis);
    var exec = require(&#39;child_process&#39;).exec;
    var cmd = `iconv -c -f sjis -t utf-8 ${filePath}`;
    var child = exec(cmd, (err, stdout, stderr) =&amp;gt; {
      if (err) reject(err);
      else resolve(stdout);
    });
});
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;http://www.bokukoko.info/entry/2015/08/30/AWS_Lambda%E5%86%85%E3%81%A7%E6%96%87%E5%AD%97%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E5%A4%89%E6%8F%9B%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95&#34;&gt;AWS Lambdaå†…ã§æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›ã™ã‚‹æ–¹æ³• - ãƒœã‚¯ã‚³ã‚³&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Node.jsã§Dateã‚’ä»»æ„ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ–‡å­—åˆ—ã«ã™ã‚‹</title>
          <link>http://sambaiz.net/article/79/</link>
          <pubDate>Mon, 06 Mar 2017 20:18:00 &#43;0900</pubDate>
          <author></author>
          <guid>http://sambaiz.net/article/79/</guid>
          <description>&lt;p&gt;&lt;a href=&#34;http://momentjs.com/&#34;&gt;Moment.js&lt;/a&gt;ã‚’ä½¿ã†ã€‚
ç›¸å¯¾æ™‚é–“(&lt;code&gt;5 years ago&lt;/code&gt;)ã‚’å‡ºã—ãŸã‚Šã€æ—¥ä»˜ã®è¨ˆç®—(&lt;code&gt;add(3, &#39;days&#39;)&lt;/code&gt;)ã‚‚ã§ãã‚‹ä¾¿åˆ©ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚
ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚ä½¿ãˆã‚‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ npm install moment
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;const moment = require(&#39;moment&#39;)
const jst = +9
let now = moment().utcOffset(jst).format(&amp;quot;YYYY-MM-DD HH:mm:ss.SSSZ&amp;quot;);
console.log(now);
&lt;/code&gt;&lt;/pre&gt;
</description>
        </item>
      
    
      
        <item>
          <title>Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†</title>
          <link>http://sambaiz.net/article/8/</link>
          <pubDate>Fri, 15 Jul 2016 19:20:00 &#43;0900</pubDate>
          <author></author>
          <guid>http://sambaiz.net/article/8/</guid>
          <description>

&lt;h2 id=&#34;nvm-https-github-com-creationix-nvm&#34;&gt;&lt;a href=&#34;https://github.com/creationix/nvm&#34;&gt;nvm&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;å¤§ä½“ã“ã‚Œã‚’ä½¿ã£ã¦ãŠã‘ã°ã‚ˆã•ãã†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.1/install.sh | bash
$ nvm install node
$ node -v
v7.7.2

$ nvm install 6
$ node -v
v6.10.0

$ nvm ls
        v6.10.0
-&amp;gt;       v7.7.2
default -&amp;gt; node (-&amp;gt; v7.7.2)
node -&amp;gt; stable (-&amp;gt; v7.7.2) (default)
stable -&amp;gt; 7.7 (-&amp;gt; v7.7.2) (default)
iojs -&amp;gt; N/A (default)
lts/* -&amp;gt; lts/boron (-&amp;gt; v6.10.0)
lts/argon -&amp;gt; v4.8.0 (-&amp;gt; N/A)
lts/boron -&amp;gt; v6.10.0

$ nvm use node
Now using node v7.7.2 (npm v4.1.2)

$ nvm use 6
Now using node v6.10.0 (npm v3.10.10)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;n-https-github-com-tj-n&#34;&gt;&lt;a href=&#34;https://github.com/tj/n&#34;&gt;n&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;ã™ã§ã«nodeãŒå…¥ã£ã¦ã„ã‚‹ãªã‚‰ã“ã£ã¡ã‚’ä½¿ã†ã“ã¨ã‚‚ã§ãã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;n latest&lt;/code&gt;, &lt;code&gt;n stable&lt;/code&gt;, &lt;code&gt;n lts&lt;/code&gt;ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹ã€‚
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹å ´åˆã€&lt;code&gt;n &amp;lt;version&amp;gt;&lt;/code&gt;ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€&lt;code&gt;n&lt;/code&gt;ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ä¸€è¦§ã‹ã‚‰é¸æŠã§ãã‚‹ã€‚
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å‰Šé™¤ã¯&lt;code&gt;n - &amp;lt;version&amp;gt;&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ npm install -g n
$ n stable
$ node -v
v6.2.2
&lt;/code&gt;&lt;/pre&gt;
</description>
        </item>
      
    

  </channel>
</rss>
